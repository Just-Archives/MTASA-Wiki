<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8"/>
<title>FR/Debugage - Multi Theft Auto: Wiki</title>
<script>document.documentElement.className="client-js";RLCONF={"wgBreakFrames":true,"wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgRequestId":"fda789cac6d6329e6c73844c","wgCSPNonce":false,"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"FR/Debugage","wgTitle":"FR/Debugage","wgCurRevisionId":42296,"wgRevisionId":42296,"wgArticleId":6173,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Translated/Scripting Concepts"],"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgRelevantPageName":"FR/Debugage","wgRelevantArticleId":6173,"wgIsProbablyEditable":false,"wgRelevantPageIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[]};RLSTATE={"site.styles":"ready","user.styles":"ready",
"user":"ready","user.options":"loading","skins.vector.styles.legacy":"ready"};RLPAGEMODULES=["site","mediawiki.page.ready","mediawiki.toc","skins.vector.legacy.html","ext.GoogleCodePrettify","ext.gadget.ReferenceTooltips","ext.gadget.exlinks","ext.gadget.DotsSyntaxHighlighter","ext.gadget.purgetab","ext.gadget.markblocked"];</script>
<script>(RLQ=window.RLQ||[]).push(function(){mw.loader.implement("user.options@1i9g4",function($,jQuery,require,module){mw.user.tokens.set({"patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});});});</script>
<link rel="stylesheet" href="https://wiki.multitheftauto.com/load.php?lang=en&amp;modules=skins.vector.styles.legacy&amp;only=styles&amp;skin=vector"/>
<script async="" src="https://wiki.multitheftauto.com/load.php?lang=en&amp;modules=startup&amp;only=scripts&amp;raw=1&amp;skin=vector"></script>
<meta name="generator" content="MediaWiki 1.38.2"/>
<meta name="format-detection" content="telephone=no"/>
<link href="../../extensions/_MTAThemeExtensions/custom.css" rel="stylesheet"/>
<link rel="shortcut icon" href="https://wiki.multitheftauto.com/favicon.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="https://wiki.multitheftauto.com/opensearch_desc.php" title="Multi Theft Auto: Wiki (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.multitheftauto.com/api.php?action=rsd"/>
<link rel="license" href="https://www.gnu.org/licenses/fdl-1.3.html"/>
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-FR_Debugage rootpage-FR_Debugage skin-vector action-view skin-vector-legacy"><div id="mw-page-base" class="noprint"></div>
<div id="mw-head-base" class="noprint"></div>
<div id="content" class="mw-body" role="main">
	<a id="top"></a>
	<div id="siteNotice"></div>
	<div class="mw-indicators">
	</div>
	<h1 id="firstHeading" class="firstHeading mw-first-heading">FR/Debugage</h1>
	<div id="bodyContent" class="vector-body">
		<div id="siteSub" class="noprint">From Multi Theft Auto: Wiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" class="mw-body-content mw-content-ltr" lang="en" dir="ltr"><div class="mw-parser-output"><p>Quand vous scriptez vous pouvez passer à côté de certaines erreurs qui ne sont pas apparentes au premier coup d’œil. Cette page va essayer de vous indiquer quelques démarches à suivre pour localiser les erreurs.
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading"><input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none" /><div class="toctitle" lang="en" dir="ltr"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Console_de_Débogage"><span class="tocnumber">1</span> <span class="toctext">Console de Débogage</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Exemple"><span class="tocnumber">1.1</span> <span class="toctext">Exemple</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-3"><a href="#Debug_logging"><span class="tocnumber">2</span> <span class="toctext">Debug logging</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Astuces_de_déboguage"><span class="tocnumber">3</span> <span class="toctext">Astuces de déboguage</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="#Fonctions_Utiles"><span class="tocnumber">3.1</span> <span class="toctext">Fonctions Utiles</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Ajouter_un_message_pour_vérifier_quand_une_condition_if,_when_ou_how_often_est_executée"><span class="tocnumber">3.2</span> <span class="toctext">Ajouter un message pour vérifier quand une condition <i>if</i>, <i>when</i> ou <i>how often</i> est executée</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Afficher_un_message_pour_vérifier_la_&quot;valeur&quot;_d&#39;une_variable"><span class="tocnumber">3.3</span> <span class="toctext">Afficher un message pour vérifier la "valeur" d'une variable</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-8"><a href="#Exemple_2"><span class="tocnumber">4</span> <span class="toctext">Exemple</span></a>
<ul>
<li class="toclevel-2 tocsection-9"><a href="#Une_erreur_un_peu_plus_complexe"><span class="tocnumber">4.1</span> <span class="toctext">Une erreur un peu plus complexe</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-10"><a href="#Debugging_Performance_Issues"><span class="tocnumber">5</span> <span class="toctext">Debugging Performance Issues</span></a>
<ul>
<li class="toclevel-2 tocsection-11"><a href="#Exemples_de_code_qui_posent_des_problèmes_de_performances"><span class="tocnumber">5.1</span> <span class="toctext">Exemples de code qui posent des problèmes de performances</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><span id="Console_de_D.C3.A9bogage"></span><span class="mw-headline" id="Console_de_Débogage">Console de Débogage</span></h2>
<p>MTA a pour caractéristique de posséder une console de débogage qui comme son nom l'indique vous permet de déceler les erreurs dans les fonctions et scripts. Vous pouvez l'ouvrir en tapant <i>debugscript x</i> dans la console, ici <i>x</i> est le niveau de débogage:
</p>
<ul><li><b>1:</b> seulement les erreurs</li>
<li><b>2:</b> erreurs et warnings</li>
<li><b>3:</b> erreurs, warnings et messages d'informations</li></ul>
<p>Ainsi, en tapant <i>debugscript 3</i> tout les messages seront visibles, cependant le niveau 2 est recommandé la plupart du temps pour le débogage. Quand vous testez vos scripts vous devez avoir le <i>debugscript</i> à disposition  , cela vous permettra de détecter facilement les fautes d'orthographes dans les fonctions ou toutes autres erreurs aussi simple.
</p>
<h3><span class="mw-headline" id="Exemple">Exemple</span></h3>
<p>L'exemple ci-dessous contient deux erreurs:
</p>
<pre class="prettyprint lang-lua">if (getPlayerName(player) == "Fedor")
	outputChatbox("Hello Fedor")
end
</pre>
<p>Quand ce bout de code va être chargé, debugscript va vous renvoyer à peu près ceci:
</p>
<div style="color:#009900;padding:2px;">INFO: Loading script failed: C:\&lt;server path&gt;\mods\deathmatch\resources\myResource\script.lua:15: 'then' expected near ´outputChatbox'</div>
<p>Cela signifie que le code ne peut-être analysé/traité, car il y a une erreur de syntaxe. On vous montre le répertoire où se trouve le fichier, vous pouvez donc voir dans quelle ressource ce dernier se trouve ('myResource' dans notre cas) et bien sûr on vous donne le nom du fichier en question. Après le nom du fichier, on a le numéro de la ligne et encore après l'erreur/problème en question. C'est bien plus facile à résoudre maintenant, il manque juste 'then':
</p>
<pre class="prettyprint lang-lua">if (getPlayerName(player) == "Fedor") then
	outputChatbox("Hello Fedor")
end
</pre>
<p>A présent le bout de code se charge et ne renvoie aucune erreur, jusqu'à ce qu'un joueur avec le pseudo 'Fedor' fasse son apparition. Le debugscript va nous renvoyer alors:
</p>
<div style="color:#FF0000;padding:2px;">ERROR: C:\&lt;server path&gt;\mods\deathmatch\resources\d\script.lua:15: attempt to call global 'outputChatbox' (a nil value)</div>
<p>Cela signifie que la fonction appelée n'existe pas, cela s'explique facilement par le fait que le nom de la fonction est <i>outputChatBox</i> (avec une capitale <i>B</i>):
</p>
<pre class="prettyprint lang-lua">if (getPlayerName(player) == "Fedor") then
	outputChatBox("Hello Fedor")
end
</pre>
<p>Ceci n'est bien sûr qu'un exemple, il y a une multitude d'autres erreurs et problèmes, mais vous avez au moins une idée du débogage.
</p>
<h2><span class="mw-headline" id="Debug_logging">Debug logging</span></h2>
<p>You can also turn debug message logging on by editing <i>coreconfig.xml</i> in your GTA\MTA folder. You should find the following tag:
</p>
<pre class="prettyprint lang-xml">&lt;debugfile/&gt;</pre>
<p>Replace that with a tag specifying the file you want to log messages to (file path is relative from the GTA folder):
</p>
<pre class="prettyprint lang-xml">&lt;debugfile&gt;MTA\debugscript.log&lt;/debugfile&gt;</pre>
<p>All debug messages will be appended to the specified file from now on. To turn logging off, replace that line with an empty tag again.
</p>
<h2><span id="Astuces_de_d.C3.A9boguage"></span><span class="mw-headline" id="Astuces_de_déboguage">Astuces de déboguage</span></h2>
<p>Au lieu de foncer tête baisser dans votre code, il existe d'autres stratégies pour débusquer les erreurs. La plupart d'entres elles utilisent des messages/sorties (au niveau de la console) de déboguage qui sont différent suivant les situations.
</p>
<h3><span class="mw-headline" id="Fonctions_Utiles">Fonctions Utiles</span></h3>
<p>Pour commencer, il y a quelques fonctions qui peuvent être utiles pour le <i>débogage</i>.
</p>
<ul><li><a href="../OutputDebugString.html" title="OutputDebugString">outputDebugString</a> ou <a href="../OutputChatBox.html" title="OutputChatBox">outputChatBox</a> pour afficher des informations.</li>
<li><a rel="nofollow" class="external text" href="http://www.lua.org/manual/5.1/manual.html#pdf-tostring">tostring()</a> sur une variable pour la convertir en chaîne de caractères, par exemple lorsque c'est un booléen.</li>
<li><a href="../GetElementType.html" title="GetElementType">getElementType</a> pour vérifier le type d'un élément de MTA.</li></ul>
<h3><span id="Ajouter_un_message_pour_v.C3.A9rifier_quand_une_condition_if.2C_when_ou_how_often_est_execut.C3.A9e"></span><span class="mw-headline" id="Ajouter_un_message_pour_vérifier_quand_une_condition_if,_when_ou_how_often_est_executée">Ajouter un message pour vérifier quand une condition <i>if</i>, <i>when</i> ou <i>how often</i> est executée</span></h3>
<p>Un exemple typique qui vérifie si une condition <i>if</i>est executée ou non. Il vous suffit d'ajouter un message que vous reconnaîtrez lorsqu'il s'affichera quand la condition sera executée.
</p>
<pre class="prettyprint lang-lua">if (variable1 == variable2) then
	outputDebugString("Condition vérifiée")
	-- Instruction
end
</pre>
<p>Une autre pratique serait de vérifier quand est-ce que la valeur de la variable est modifiée. Il faut pour cela chercher le moment où la variable est modifiée et ajouter une fonction qui permet l'affichage d'un message juste après.
</p>
<h3><span id="Afficher_un_message_pour_v.C3.A9rifier_la_.22valeur.22_d.27une_variable"></span><span class="mw-headline" id="Afficher_un_message_pour_vérifier_la_&quot;valeur&quot;_d'une_variable">Afficher un message pour vérifier la "valeur" d'une variable</span></h3>
<p>Prenons le cas ou vous voulez créer un checkpoint (marqueur), mais ce dernier n'apparaît pas à la position attendu. La première chose que vous allez faire sera de vérifier si la fonction <a href="../CreateMarker.html" title="CreateMarker">createMarker</a> est executée. Au lieu de faire ceci, vous pouvez vérifier les valeurs qui sont utilisées par la fonction <a href="../CreateMarker.html" title="CreateMarker">createMarker</a>.
</p>
<pre class="prettyprint lang-lua">outputChatBox(tostring(x).." "..tostring(y).." "..tostring(z))
createMarker(x,y,z)
</pre>
<p>Ce code aura pour conséquence de vous afficher un message avec les trois valeurs des variables qui sont utilisées en tant que coordonnées pour le marqueur. Vous pouvez maintenant comparer les valeurs obtenues avec celle désirées. Le <a rel="nofollow" class="external text" href="http://www.lua.org/manual/5.1/manual.html#pdf-tostring">tostring()</a> vous permettra de vous assurer que les valeurs des variables seront transformées en "string" (chaîne de caractères), même si c'est un boléen.
</p>
<h2><span class="mw-headline" id="Exemple_2">Exemple</span></h2>
<p>Imaginons que vous créiez un <i>colshape</i> (figure géométrique bi/tridimensionnelle pour détecter les collisions) quelque part et que vous souhaitiez qu'un joueur reste 10 secondes dans celle-ci avant d'éxecuter un code.
</p>
<pre class="prettyprint lang-lua">function colShapeHit(player)
	-- défini un timer pour afficher un message (le timer peut très bien éxécuter une fonction)
	-- stocke l'id du timer dans un tableau en utilisant le joueur (''player'') comme index/case.
	colshapeTimer[player] = setTimer(outputChatBox,10000,1,"Le joueur est depuis 10 secondes dans le colshape!")
end
addEventHandler("onColShapeHit",getRootElement(),colShapeHit)

function colShapeLeave(player)
	-- arrête le timer dès que le joueur quitte le colshape
	killTimer(colshapeTimer[player])
end
addEventHandler("onColShapeLeave",getRootElement(),colShapeLeave)
</pre>
<p>Quand le joueur entre dans le colshape, le debugscript affiche le message suivant:
</p>
<div style="color:#FF0000;padding:2px;">ERROR: ..[path]: attempt to index global 'colshapeTimer' (a nil value)</div>
<p>Cela signifie que vous voulez stocker une valeur dans un tableau (à la case <i>player</i>) qui n'existe pas. Dans l'exemple, le problème se pose quand vous voulez stocker l'id du timer dans le tableau. Nous devons donc vérifier si le tableau existe et si non en créer un.
</p>
<pre class="prettyprint lang-lua">function colShapeHit(player)
	if (colshapeTimer == nil) then
		colshapeTimer = {}
	end
	-- défini un timer pour afficher un message (le timer peut très bien éxécuter une fonction)
	-- stocke l'id du timer dans un tableau en utilisant le joueur (''player'') comme index/case.
	colshapeTimer[player] = setTimer(outputChatBox,10000,1,"Le joueur est depuis 10 secondes dans le colshape!")
end
addEventHandler("onColShapeHit",getRootElement(),colShapeHit)

function colShapeLeave(player)
	-- arrête le timer dès que le joueur quitte le colshape
	killTimer(colshapeTimer[player])
end
addEventHandler("onColShapeLeave",getRootElement(),colShapeLeave)
</pre>
<p>Ceci fait il nous reste quand même un <i>warning</i> (avertissement).Attendez le message et quittez à nouveau le colshape:
</p>
<div style="color:#00FF00;padding:2px;">WARNING: [..]: Bad argument @ 'killTimer' Line: ..</div>
<p>À part ceci (nous en parlerons plus tard) tous semble bien fonctionner. Un joueur entre dans le <i>colshape</i>, le timer se lance, si il reste un message s'affiche, si il quitte le <i>colshape</i> le timer est arrêté.
</p>
<h3><span class="mw-headline" id="Une_erreur_un_peu_plus_complexe">Une erreur un peu plus complexe</span></h3>
<p>Cependant, pour une quelconque raison le message est envoyé deux fois quand on reste dans le cercle de collision alors qu'on est dans un véhicule. Puisque c'est le cas on conclu qu'un code est exécuté deux fois, on va déboguer pour vérifier cela.
</p>
<pre class="prettyprint lang-lua">function colShapeHit(player)
	if (colshapeTimer == nil) then
		colshapeTimer = {}
	end
	-- ajout d'un message de debugage
	outputDebugString("colShapeHit")
	-- ajout d'un timer pour afficher un message (peut aussi appeler une fonction)
	-- stockage du timer dans un tableau d'id en utilisant le joueur comme ordre de rangement
	colshapeTimer[player] = setTimer(outputChatBox,10000,1,"The player stayed 10 seconds in the colshape!")
end
addEventHandler("onColShapeHit",getRootElement(),colShapeHit)

function colShapeLeave(player)
	-- ajout d'un message de debugage
	outputDebugString("colShapeLeave")
	-- arrête le timer quand le joueur quitte le colshape
	killTimer(colshapeTimer[player])
end
addEventHandler("onColShapeLeave",getRootElement(),colShapeLeave)
</pre>
<p>Nous remarquons que les deux fonctions rattachées aux événements sont éxécutées deux fois, mais seulement une lorsque qu'on est à pied. On peut donc penser que le véhicule déclenche aussi les événements. Pour confirmer cette théorie , nous allons vérifier la variable <i>player</i> qui <b>devrait</b> contenir un <i>élément joueur</i>.
</p>
<pre class="prettyprint lang-lua">function colShapeHit(player)
	if (colshapeTimer == nil) then
		colshapeTimer = {}
	end
	-- ajout d'un message de debugage avec le type de l'élément
	outputDebugString("colShapeHit "..getElementType(player))
	-- ajout d'un timer pour afficher un message (peut aussi appeler une fonction)
	-- stockage du timer dans un tableau d'id en utilisant le joueur comme ordre de rangement
	colshapeTimer[player] = setTimer(outputChatBox,10000,1,"The player stayed 10 seconds in the colshape!")
end
addEventHandler("onColShapeHit",getRootElement(),colShapeHit)

function colShapeLeave(player)
	-- ajout d'un message de debugage avec le type de l'élément
	outputDebugString("colShapeLeave "..getElementType(player))
	-- arrête le timer quand le joueur quitte le colshape
	killTimer(colshapeTimer[player])
end
addEventHandler("onColShapeLeave",getRootElement(),colShapeLeave)
</pre>
<p>Le message de débugage nous informe que, l'une des variables <i>player</i> est un joueur, et que l'autre, est un véhicule. Si nous voulons éxecuter notre code seulement quand un joueur entre dans le <i>colshape</i>, nous devons rajouter un <i>if</i> (condition) qui stoppera l'éxecution du code si ce n'est pas un joueur.
</p>
<pre class="prettyprint lang-lua">function colShapeHit(player)
	if (colshapeTimer == nil) then
		colshapeTimer = {}
	end
	-- vérification du type de l'élement
	if (getElementType(player) ~= "player") then return end
	-- ajout d'un message avec le type de l'élement
	outputDebugString("colShapeHit "..getElementType(player))
	-- ajout d'un timer pour afficher un message (peut aussi appeler une fonction)
	-- stockage du timer dans un tableau d'id en utilisant le joueur comme ordre de rangement
	colshapeTimer[player] = setTimer(outputChatBox,10000,1,"The player stayed 10 seconds in the colshape!")
end
addEventHandler("onColShapeHit",getRootElement(),colShapeHit)

function colShapeLeave(player)
	-- vérification du type de l'élement
	if (getElementType(player) ~= "player") then return end
	-- ajout d'un message avec le type de l'élement
	outputDebugString("colShapeLeave "..getElementType(player))
	-- arrête le timer quand le joueur quitte le colshape
	killTimer(colshapeTimer[player])
end
addEventHandler("onColShapeLeave",getRootElement(),colShapeLeave)
</pre>
<p>Maintenant le code devrait fonctionner comme nous le souhaitions, mais nous avons toujours l'avertissement mentionné plus tôt. Cela est dû au fait que nous essayons d'arrêter un timer qui , quand le joueur est resté dans le colshape 10 secondes est éxecuté, n'existe plus. Il y a différentes façons de se débarasser de cet avertissement (si on part du principe qu'on sait qu'il n'existe plus à partir d'un certain moment et qu'on peut l'arrêter seulement si il ne s'est pas éxecuté).
Une des méthodes serait de vérifier si le timer stocker dans le tableau existe. Pour faire cela, nous devons utiliser <a href="../IsTimer.html" title="IsTimer">isTimer</a> avant d'arrêter le timer.
</p>
<pre class="prettyprint lang-lua">if (isTimer(colshapeTimer[player])) then
	killTimer(colshapeTimer[player])
end
</pre>
<p>Le code final ressemblerait à ceci:
</p>
<pre class="prettyprint lang-lua">function colShapeHit(player)
	if (colshapeTimer == nil) then
		colshapeTimer = {}
	end
	-- vérification du type de l'élement
	if (getElementType(player) ~= "player") then return end
	-- ajout d'un message avec le type de l'élement
	outputDebugString("colShapeHit "..getElementType(player))
	-- ajout d'un timer pour afficher un message (peut aussi appeler une fonction)
	-- stockage du timer dans un tableau d'id en utilisant le joueur comme ordre de rangement
	colshapeTimer[player] = setTimer(outputChatBox,10000,1,"The player stayed 10 seconds in the colshape!")
end
addEventHandler("onColShapeHit",getRootElement(),colShapeHit)

function colShapeLeave(player)
	-- vérification du type de l'élement
	if (getElementType(player) ~= "player") then return end
	-- ajout d'un message avec le type de l'élement
	outputDebugString("colShapeLeave "..getElementType(player))
	-- arrête le timer quand le joueur quitte le colshape
	if (isTimer(colshapeTimer[player])) then
		killTimer(colshapeTimer[player])
	end
end
addEventHandler("onColShapeLeave",getRootElement(),colShapeLeave)
</pre>
<h2><span class="mw-headline" id="Debugging_Performance_Issues">Debugging Performance Issues</span></h2>
<p>Si vous serveur utilise plus de ressource qu'il ne devrait ou si vous voulez vous assurez que votre code est efficace, vous pourrez trouver les brebis galeuses avec l'outil <i>performancebrowser</i>. Pour le lancer taper dans votre console "start performancebrowser" si cette ressource n'exite pas assurer de bien la posséder à l'emplacement adequat. Cet outil fourni un bon nombre d'information sur le debugage de perfomance. Fuite de mémoire, perte d'éléments et utilisation intensive du CPU sont facilement décelable via cet outil. Si vous utilisez l'option -d vous pourrez voir quelles fonctions utilisent de manière excéssive le CPU.
</p><p>Pour accèder au <i>performancebrowser</i> vous devez entrer cette adresse dans votre navigateur de recherche: <a rel="nofollow" class="external free" href="http://serveriphere:serverhttpporthere/performancebrowser/">http://serverIPHere:serverHTTPPortHere/performancebrowser/</a> Noterque le / à la fin est obligatoire. Donc par exemple: <a rel="nofollow" class="external free" href="http://127.0.0.1:22005/performancebrowser/">http://127.0.0.1:22005/performancebrowser/</a> . Ensuite, vous devez vous logguer en jeu avec un compte administrateur ou un compte ayant accès à la ressource "general.HTTP" . La plupart des informations dont vous aurez besoin se trouvent dans les catégories "Lua timing" et "Lua memory". Chercher les valeurs qui sont plus élevées que les autres.
</p>
<h3><span id="Exemples_de_code_qui_posent_des_probl.C3.A8mes_de_performances"></span><span class="mw-headline" id="Exemples_de_code_qui_posent_des_problèmes_de_performances">Exemples de code qui posent des problèmes de performances</span></h3>
<p>L'ajout de données à un tableau sans les supprimer ensuite, même si ça prendra quelques mois ou années avant de poser des problèmes.
</p>
<pre class="prettyprint lang-lua">local someData = {}

function storeData()
    someData[source] = true
    -- Rien ne gère le moment ou le joueur quitte le jeu, c'est donc considéré comme une perte de mémoire.
    -- Using the Lua timing tab you can detect the RAM usage of each resource.
end
addEventHandler("onPlayerJoin", root, storeData)
</pre>
<p>Element leaking is possible if you use temporary colshapes for whatever reason and may not destroy them. This would cause bandwidth, CPU and memory performance issues over time.
</p>
<pre class="prettyprint lang-lua">function useTemporaryCol()
    local col = createColCircle(some code here)
    if (normally this should happen) then
        destroyElement(col)
    end
    -- But sometimes it didn't so the script ended but the collision area remained and over time
    -- you may end up with hundreds to thousands of pointless collision areas. 
    -- The Lua timing tab allows you to see the amount of elements each script has created.
end
</pre>
<p>High CPU usage resulting in the server FPS dropping so much that the server is unplayable. In under 24 hours this can create havoc on a very busy server. The amount of "refs" in the Lua timing detect this type of build up, surprisingly the Lua timing tab didn't help in this case but Lua memory did.
</p>
<pre class="prettyprint lang-lua">addEventHandler("onPlayerJoin", root, function()
    -- Code for joiner
    addEventHandler("onPlayerQuit", root, function()
        -- Code for when they have quit
        -- See the problem? It's bound to root which the event handler is being added again and again and again
    end)
end)
</pre>
<p>A function uses up a lot of your CPU because whatever it does takes a long time. This is just some function that takes a long time to complete. Without performancebrowser you'd have no idea its the cause but with performancebrowser you can see that a resource is using lots of CPU in the Lua timing tab. If you then enter: -d into the options edit box it will even tell you what file name and first line of the function that is using up so much CPU.
</p>
<pre class="prettyprint lang-lua">function someDodgyCode()
    for i=1, 100000 do
        -- some code
    end
end
</pre>
<!-- 
NewPP limit report
Cached time: 20220728180610
Cache expiry: 86400
Reduced expiry: false
Complications: []
CPU time usage: 0.015 seconds
Real time usage: 0.017 seconds
Preprocessor visited node count: 149/1000000
Post‐expand include size: 558/2097152 bytes
Template argument size: 345/2097152 bytes
Highest expansion depth: 3/100
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 7391/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    4.647      1 -total
 44.58%    2.072      2 Template:Debug_error
 24.68%    1.147      1 Template:Debug_info
 19.87%    0.923      1 Template:Debug_warning
-->

<!-- Saved in parser cache with key wiki-wiki_dev_:pcache:idhash:6173-0!canonical and timestamp 20220728180610 and revision id 42296. Serialized with JSON.
 -->
</div>
<div class="printfooter">Retrieved from "<a dir="ltr" href="https://wiki.multitheftauto.com/index.php?title=FR/Debugage&amp;oldid=42296">https://wiki.multitheftauto.com/index.php?title=FR/Debugage&amp;oldid=42296</a>"</div></div>
		<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="../Special_Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../Category_Translated/Scripting_Concepts.html" title="Category:Translated/Scripting Concepts">Translated/Scripting Concepts</a></li></ul></div></div>
	</div>
</div>

<div id="mw-navigation">
	<h2>Navigation menu</h2>
	<div id="mw-head">
		
<nav id="p-personal" class="mw-portlet mw-portlet-personal vector-user-menu-legacy vector-menu" aria-labelledby="p-personal-label" role="navigation" 
	 >
	<label id="p-personal-label" aria-label="" class="vector-menu-heading">
		<span class="vector-menu-heading-label">Personal tools</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="pt-createaccount" class="mw-list-item"><a href="https://wiki.multitheftauto.com/index.php?title=Special:CreateAccount&amp;returnto=FR%2FDebugage" title="You are encouraged to create an account and log in; however, it is not mandatory"><span>Create account</span></a></li><li id="pt-login" class="mw-list-item"><a href="https://wiki.multitheftauto.com/index.php?title=Special:UserLogin&amp;returnto=FR%2FDebugage" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o"><span>Log in</span></a></li></ul>
		
	</div>
</nav>

		<div id="left-navigation">
			
<nav id="p-namespaces" class="mw-portlet mw-portlet-namespaces vector-menu vector-menu-tabs" aria-labelledby="p-namespaces-label" role="navigation" 
	 >
	<label id="p-namespaces-label" aria-label="" class="vector-menu-heading">
		<span class="vector-menu-heading-label">Namespaces</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="ca-nstab-main" class="selected mw-list-item"><a href="Debugage.html" title="View the content page [c]" accesskey="c"><span>Page</span></a></li><li id="ca-talk" class="new mw-list-item"><a href="https://wiki.multitheftauto.com/index.php?title=Talk:FR/Debugage&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page (page does not exist) [t]" accesskey="t"><span>Discussion</span></a></li></ul>
		
	</div>
</nav>

			
<nav id="p-variants" class="mw-portlet mw-portlet-variants emptyPortlet vector-menu-dropdown-noicon vector-menu vector-menu-dropdown" aria-labelledby="p-variants-label" role="navigation" 
	 >
	<input type="checkbox"
		id="p-variants-checkbox"
		role="button"
		aria-haspopup="true"
		data-event-name="ui.dropdown-p-variants"
		class="vector-menu-checkbox" aria-labelledby="p-variants-label" />
	<label id="p-variants-label" aria-label="Change language variant" class="vector-menu-heading">
		<span class="vector-menu-heading-label">English</span>
			<span class="vector-menu-checkbox-expanded">expanded</span>
			<span class="vector-menu-checkbox-collapsed">collapsed</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</nav>

		</div>
		<div id="right-navigation">
			
<nav id="p-views" class="mw-portlet mw-portlet-views vector-menu vector-menu-tabs" aria-labelledby="p-views-label" role="navigation" 
	 >
	<label id="p-views-label" aria-label="" class="vector-menu-heading">
		<span class="vector-menu-heading-label">Views</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="ca-view" class="selected mw-list-item"><a href="Debugage.html"><span>Read</span></a></li><li id="ca-viewsource" class="mw-list-item"><a href="https://wiki.multitheftauto.com/index.php?title=FR/Debugage&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e"><span>View source</span></a></li><li id="ca-history" class="mw-list-item"><a href="https://wiki.multitheftauto.com/index.php?title=FR/Debugage&amp;action=history" title="Past revisions of this page [h]" accesskey="h"><span>View history</span></a></li></ul>
		
	</div>
</nav>

			
<nav id="p-cactions" class="mw-portlet mw-portlet-cactions emptyPortlet vector-menu-dropdown-noicon vector-menu vector-menu-dropdown" aria-labelledby="p-cactions-label" role="navigation"  title="More options"
	 >
	<input type="checkbox"
		id="p-cactions-checkbox"
		role="button"
		aria-haspopup="true"
		data-event-name="ui.dropdown-p-cactions"
		class="vector-menu-checkbox" aria-labelledby="p-cactions-label" />
	<label id="p-cactions-label" aria-label="" class="vector-menu-heading">
		<span class="vector-menu-heading-label">More</span>
			<span class="vector-menu-checkbox-expanded">expanded</span>
			<span class="vector-menu-checkbox-collapsed">collapsed</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</nav>

			
<div id="p-search" role="search" class="vector-search-box-vue  vector-search-box-show-thumbnail vector-search-box-auto-expand-width vector-search-box">
	<div>
			<h3 >
				<label for="searchInput">Search</label>
			</h3>
		<form action="https://wiki.multitheftauto.com/index.php" id="searchform"
			class="vector-search-box-form">
			<div id="simpleSearch"
				class="vector-search-box-inner"
				 data-search-loc="header-navigation">
				<input class="vector-search-box-input"
					 type="search" name="search" placeholder="Search Multi Theft Auto: Wiki" aria-label="Search Multi Theft Auto: Wiki" autocapitalize="sentences" title="Search Multi Theft Auto: Wiki [f]" accesskey="f" id="searchInput"
				/>
				<input type="hidden" name="title" value="Special:Search"/>
				<input id="mw-searchButton"
					 class="searchButton mw-fallbackSearchButton" type="submit" name="fulltext" title="Search the pages for this text" value="Search" />
				<input id="searchButton"
					 class="searchButton" type="submit" name="go" title="Go to a page with this exact name if it exists" value="Go" />
			</div>
		</form>
	</div>
</div>

		</div>
	</div>
	

<div id="mw-panel">
	<div id="p-logo" role="banner">
		<a class="mw-wiki-logo" href="../Main_Page.html"
			title="Visit the main page"></a>
	</div>
	
<nav id="p-navigation" class="mw-portlet mw-portlet-navigation vector-menu vector-menu-portal portal" aria-labelledby="p-navigation-label" role="navigation" 
	 >
	<label id="p-navigation-label" aria-label="" class="vector-menu-heading">
		<span class="vector-menu-heading-label">Navigation</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="n-Home" class="mw-list-item"><a href="../Main_Page.html"><span>Home</span></a></li><li id="n-How-you-can-help" class="mw-list-item"><a href="../How_you_can_help.html"><span>How you can help</span></a></li><li id="n-recentchanges" class="mw-list-item"><a href="../Special_RecentChanges.html" icon="recentChanges" title="A list of recent changes in the wiki [r]" accesskey="r"><span>Recent changes</span></a></li><li id="n-randompage" class="mw-list-item"><a href="../GetPlayerOccupiedVehicleSeat.html" icon="die" title="Load a random page [x]" accesskey="x"><span>Random page</span></a></li></ul>
		
	</div>
</nav>

	
<nav id="p-Reference" class="mw-portlet mw-portlet-Reference vector-menu vector-menu-portal portal" aria-labelledby="p-Reference-label" role="navigation" 
	 >
	<label id="p-Reference-label" aria-label="" class="vector-menu-heading">
		<span class="vector-menu-heading-label">Reference</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="n-Client-Functions" class="mw-list-item"><a href="../Client_Scripting_Functions.html"><span>Client Functions</span></a></li><li id="n-Client-Events" class="mw-list-item"><a href="../Client_Scripting_Events.html"><span>Client Events</span></a></li><li id="n-Server-Functions" class="mw-list-item"><a href="../Server_Scripting_Functions.html"><span>Server Functions</span></a></li><li id="n-Server-Events" class="mw-list-item"><a href="../Server_Scripting_Events.html"><span>Server Events</span></a></li><li id="n-Shared-Functions" class="mw-list-item"><a href="../Shared_Scripting_Functions.html"><span>Shared Functions</span></a></li><li id="n-Useful-Functions" class="mw-list-item"><a href="../Useful_Functions.html"><span>Useful Functions</span></a></li><li id="n-MTA-Classes" class="mw-list-item"><a href="../MTA_Classes.html"><span>MTA Classes</span></a></li><li id="n-MTA-Elements" class="mw-list-item"><a href="../Element.html"><span>MTA Elements</span></a></li><li id="n-Element-Tree" class="mw-list-item"><a href="../Element_tree.html"><span>Element Tree</span></a></li></ul>
		
	</div>
</nav>

<nav id="p-tb" class="mw-portlet mw-portlet-tb vector-menu vector-menu-portal portal" aria-labelledby="p-tb-label" role="navigation" 
	 >
	<label id="p-tb-label" aria-label="" class="vector-menu-heading">
		<span class="vector-menu-heading-label">Tools</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="t-whatlinkshere" class="mw-list-item"><a href="../Special_WhatLinksHere/FR/Debugage.html" title="A list of all wiki pages that link here [j]" accesskey="j"><span>What links here</span></a></li><li id="t-recentchangeslinked" class="mw-list-item"><a href="../Special_RecentChangesLinked/FR/Debugage.html" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k"><span>Related changes</span></a></li><li id="t-specialpages" class="mw-list-item"><a href="../Special_SpecialPages.html" title="A list of all special pages [q]" accesskey="q"><span>Special pages</span></a></li><li id="t-print" class="mw-list-item"><a href="javascript:print();" rel="alternate" title="Printable version of this page [p]" accesskey="p"><span>Printable version</span></a></li><li id="t-permalink" class="mw-list-item"><a href="https://wiki.multitheftauto.com/index.php?title=FR/Debugage&amp;oldid=42296" title="Permanent link to this revision of the page"><span>Permanent link</span></a></li><li id="t-info" class="mw-list-item"><a href="https://wiki.multitheftauto.com/index.php?title=FR/Debugage&amp;action=info" title="More information about this page"><span>Page information</span></a></li></ul>
		
	</div>
</nav>

	
<nav id="p-lang" class="mw-portlet mw-portlet-lang vector-menu vector-menu-portal portal" aria-labelledby="p-lang-label" role="navigation" 
	 >
	<label id="p-lang-label" aria-label="" class="vector-menu-heading">
		<span class="vector-menu-heading-label">In other languages</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li class="interlanguage-link interwiki-it mw-list-item"><a href="http://wiki.multitheftauto.com/index.php?title=IT/Guida_al_Debug" title="Guida al Debug – italiano" lang="it" hreflang="it" class="interlanguage-link-target"><span>Italiano</span></a></li><li class="interlanguage-link interwiki-ru mw-list-item"><a href="http://wiki.multitheftauto.com/index.php?title=RU/Debugging" title="Debugging – русский" lang="ru" hreflang="ru" class="interlanguage-link-target"><span>Русский</span></a></li></ul>
		
	</div>
</nav>

</div>

</div>

<footer id="footer" class="mw-footer" role="contentinfo" >
	<ul id="footer-info">
	<li id="footer-info-lastmod"> This page was last edited on 29 September 2014, at 12:11.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/licenses/fdl-1.3.html">GNU Free Documentation License 1.3</a> unless otherwise noted.</li>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="../Multi_Theft_Auto__Wiki_Privacy_policy.html" title="Multi Theft Auto: Wiki:Privacy policy">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../Multi_Theft_Auto__Wiki_About.html" title="Multi Theft Auto: Wiki:About">About Multi Theft Auto: Wiki</a></li>
	<li id="footer-places-disclaimer"><a href="../Multi_Theft_Auto__Wiki_General_disclaimer.html" title="Multi Theft Auto: Wiki:General disclaimer">Disclaimers</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/licenses/fdl-1.3.html"><img src="../../resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3" width="88" height="31" loading="lazy"/></a></li>
	<li id="footer-poweredbyico"><a href="https://www.mediawiki.org/"><img src="../../resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"/></a></li>
</ul>

</footer>

<script src="../../extensions/_MTAThemeExtensions/main.js"></script><script src="../../extensions/_MTAThemeExtensions/topmenu.js"></script>
<script>(RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgPageParseReport":{"limitreport":{"cputime":"0.015","walltime":"0.017","ppvisitednodes":{"value":149,"limit":1000000},"postexpandincludesize":{"value":558,"limit":2097152},"templateargumentsize":{"value":345,"limit":2097152},"expansiondepth":{"value":3,"limit":100},"expensivefunctioncount":{"value":0,"limit":100},"unstrip-depth":{"value":0,"limit":20},"unstrip-size":{"value":7391,"limit":5000000},"timingprofile":["100.00%    4.647      1 -total"," 44.58%    2.072      2 Template:Debug_error"," 24.68%    1.147      1 Template:Debug_info"," 19.87%    0.923      1 Template:Debug_warning"]},"cachereport":{"timestamp":"20220728180610","ttl":86400,"transientcontent":false}}});mw.config.set({"wgBackendResponseTime":90});});</script>
</body>
</html>