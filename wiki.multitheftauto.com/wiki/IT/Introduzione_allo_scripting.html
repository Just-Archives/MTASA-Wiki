<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8"/>
<title>IT/Introduzione allo scripting - Multi Theft Auto: Wiki</title>
<script>document.documentElement.className="client-js";RLCONF={"wgBreakFrames":true,"wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgRequestId":"56915a0d675784082f7f595c","wgCSPNonce":false,"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"IT/Introduzione_allo_scripting","wgTitle":"IT/Introduzione allo scripting","wgCurRevisionId":21332,"wgRevisionId":21332,"wgArticleId":3668,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["IT/Pagine italiane","100%","IT/Concetti di scripting","IT/Guide e tutorial"],"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgRelevantPageName":"IT/Introduzione_allo_scripting","wgRelevantArticleId":3668,"wgIsProbablyEditable":false,"wgRelevantPageIsProbablyEditable":false
,"wgRestrictionEdit":[],"wgRestrictionMove":[]};RLSTATE={"site.styles":"ready","user.styles":"ready","user":"ready","user.options":"loading","skins.vector.styles.legacy":"ready"};RLPAGEMODULES=["site","mediawiki.page.ready","mediawiki.toc","skins.vector.legacy.html","ext.GoogleCodePrettify","ext.gadget.ReferenceTooltips","ext.gadget.exlinks","ext.gadget.DotsSyntaxHighlighter","ext.gadget.purgetab","ext.gadget.markblocked"];</script>
<script>(RLQ=window.RLQ||[]).push(function(){mw.loader.implement("user.options@1i9g4",function($,jQuery,require,module){mw.user.tokens.set({"patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});});});</script>
<link rel="stylesheet" href="https://wiki.multitheftauto.com/load.php?lang=en&amp;modules=skins.vector.styles.legacy&amp;only=styles&amp;skin=vector"/>
<script async="" src="https://wiki.multitheftauto.com/load.php?lang=en&amp;modules=startup&amp;only=scripts&amp;raw=1&amp;skin=vector"></script>
<meta name="generator" content="MediaWiki 1.38.2"/>
<meta name="format-detection" content="telephone=no"/>
<link href="https://wiki.multitheftauto.com/extensions/_MTAThemeExtensions/custom.css" rel="stylesheet"/>
<link rel="shortcut icon" href="https://wiki.multitheftauto.com/favicon.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="https://wiki.multitheftauto.com/opensearch_desc.php" title="Multi Theft Auto: Wiki (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.multitheftauto.com/api.php?action=rsd"/>
<link rel="license" href="https://www.gnu.org/licenses/fdl-1.3.html"/>
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-IT_Introduzione_allo_scripting rootpage-IT_Introduzione_allo_scripting skin-vector action-view skin-vector-legacy"><div id="mw-page-base" class="noprint"></div>
<div id="mw-head-base" class="noprint"></div>
<div id="content" class="mw-body" role="main">
	<a id="top"></a>
	<div id="siteNotice"></div>
	<div class="mw-indicators">
	</div>
	<h1 id="firstHeading" class="firstHeading mw-first-heading">IT/Introduzione allo scripting</h1>
	<div id="bodyContent" class="vector-body">
		<div id="siteSub" class="noprint">From Multi Theft Auto: Wiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" class="mw-body-content mw-content-ltr" lang="en" dir="ltr"><div class="mw-parser-output"><div style="border:1px dashed blue;background-color:#E2E2E2;font-family:courier new, courier;padding-left:10px;margin-bottom:20px;"><strong style="color:blue;">«</strong> Torna alla <a href="Pagina_principale.html" title="IT/Pagina principale">Pagina principale italiana <span style="color:green;">▇</span><span style="color:white;">▇</span><span style="color:red;">▇</span></a>.</div>
<p>Le <i>Resources</i> (Risorse) sono la parte principale di MTA. Essenzialmente, una risorsa è una cartella o un archivio zip che contiene una serie di files ed un file <i>meta</i> che contiene informazioni su come il server deve gestire la risorsa e cosa contengono i suoi componenti. Una risorsa può essere vista come uno dei programmi che girano su un sistema operativo: può essere avviata e fermata, e più risorse possono essere eseguite contemporaneamente.
</p><p>Tutto ciò che ha a che fare con lo scripting avviene nelle risorse, ciò che una risorsa fà dipende da se si tratta di una gamemode, una mappa o qualsiasi altra cosa.
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading"><input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none" /><div class="toctitle" lang="en" dir="ltr"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Creare_un_semplice_script"><span class="tocnumber">1</span> <span class="toctext">Creare un semplice script</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Preparazione"><span class="tocnumber">1.1</span> <span class="toctext">Preparazione</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Scrivere_uno_script"><span class="tocnumber">1.2</span> <span class="toctext">Scrivere uno script</span></a>
<ul>
<li class="toclevel-3 tocsection-4"><a href="#A_proposito_dei_command_handlers"><span class="tocnumber">1.2.1</span> <span class="toctext">A proposito dei command handlers</span></a></li>
<li class="toclevel-3 tocsection-5"><a href="#Programmare_la_funzione"><span class="tocnumber">1.2.2</span> <span class="toctext">Programmare la funzione</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#Cosa_c&#39;è_da_sapere"><span class="tocnumber">2</span> <span class="toctext">Cosa c'è da sapere</span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="#Scripts_client-side_e_scripts_server-side"><span class="tocnumber">2.1</span> <span class="toctext">Scripts client-side e scripts server-side</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Script_più_complessi"><span class="tocnumber">2.2</span> <span class="toctext">Script più complessi</span></a>
<ul>
<li class="toclevel-3 tocsection-9"><a href="#Primo_esempio_-_Un_utility_script"><span class="tocnumber">2.2.1</span> <span class="toctext">Primo esempio - Un <i>utility</i> script</span></a></li>
<li class="toclevel-3 tocsection-10"><a href="#Secondo_esempio_-_Una_gamemode"><span class="tocnumber">2.2.2</span> <span class="toctext">Secondo esempio - Una gamemode</span></a></li>
<li class="toclevel-3 tocsection-11"><a href="#Terzo_esempio_-_Una_mappa"><span class="tocnumber">2.2.3</span> <span class="toctext">Terzo esempio - Una mappa</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-12"><a href="#Eventi"><span class="tocnumber">2.3</span> <span class="toctext">Eventi</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-13"><a href="#Cosa_fare_dopo"><span class="tocnumber">3</span> <span class="toctext">Cosa fare dopo</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Creare_un_semplice_script">Creare un semplice script</span></h2>
<p>Innanzitutto, mettiamo caso volessimo creare uno script per aggiungere un comando 'createvehicle' che i giocatori possano usare per far spawnare un veicolo alla loro attuale posizione.
</p>
<h3><span class="mw-headline" id="Preparazione">Preparazione</span></h3>
<p>Come detto sopra, una risorsa è una cartella o un archivio zip, quindi prima di tutto dovremo creare una cartella. Il nome della cartella è il nome della risorsa, che viene usato per avviarla o fermarla o come riferimento negli script. Nel nostro esempio la chiameremo <i>commands</i>.
</p><p>Ciò di cui qualsiasi risorsa ha bisogno è il file <i>meta.xml</i>. Nel nostro caso, vogliamo creare uno script che fornisca determinati comandi ad un giocatore, dobbiamo quindi dire al server di caricare il nostro script, che chiameremo <i>script.lua</i>.
</p><p>Ecco il contenuto del nostro file <i>meta.xml</i>:
</p>
<pre class="prettyprint lang-xml">&lt;meta&gt;
     &lt;info author="TuoNome" description="Alcuni semplici comandi" /&gt;
     &lt;script src="script.lua" /&gt;
&lt;/meta&gt;
</pre>
<p>Creiamo ora il file che conterrà il nostro script: <i>script.lua</i>, nella stessa cartella di <i>meta.xml</i>. Adesso abbiamo i seguenti files:
</p>
<pre class="prettyprint lang-xml">/commands/meta.xml
/commands/script.lua
</pre>
<h3><span class="mw-headline" id="Scrivere_uno_script">Scrivere uno script</span></h3>
<p>Iniziamo a scrivere il contenuto del file <i>script.lua</i>. Come sopra, vogliamo creare un comando per spawnare un veicolo nella posizione di chi esegue il comando stesso. Prima di tutto dobbiamo creare una funzione che possa essere eseguita all'esecuzione dello script, ed un <i>command handler</i> che dica al gioco di eseguire la nostra funzione quando il nostro comando viene chiamato.
</p>
<pre class="prettyprint lang-lua">-- Creiamo la funzione per spawnare un nuovo veicolo, con gli argomenti "thePlayer", "command" e "vehicle"
function createVehicleForPlayer(thePlayer, command, vehicle)
   -- Qui metteremo le funzioni per creare il veicolo, ottenere la posizione del giocatore eccetera
end

-- Creiamo quindi il "command handler"
addCommandHandler("createvehicle", createVehicleForPlayer)
</pre>
<p><i>Nota: Negli esempi di script i nomi delle funzioni sono dei link che portano alla relativa pagina per informazioni sulla funzione stessa.</i>
</p>
<h4><span class="mw-headline" id="A_proposito_dei_command_handlers">A proposito dei command handlers</span></h4>
<p>Il primo argomento della funzione <a href="https://wiki.multitheftauto.com/index.php?title=IT/addCommandHandler&amp;action=edit&amp;redlink=1" class="new" title="IT/addCommandHandler (page does not exist)">addCommandHandler</a> è il nome del comando che il giocatore dovrà eseguire, il secondo argomento è invece la funzione che il comando attiverà, nell'esempio sopra <i>createVehicleForPlayer</i>.
</p><p>Se hai già un'esperienza di base nello scripting o nella programmazione, saprai già che una funzione si chiama nel seguente modo:
</p>
<pre class="prettyprint lang-lua">nomeFunzione(argomento1, argomento2, argomento3, ...)
</pre>
<p>Abbiamo infatti chiamato la funzione <a href="https://wiki.multitheftauto.com/index.php?title=IT/addCommandHandler&amp;action=edit&amp;redlink=1" class="new" title="IT/addCommandHandler (page does not exist)">addCommandHandler</a> in questo modo, e dato che anche <i>createVehicleForPlayer</i> è una funzione, può essere anche lei chiamata in tale modo. Ma stiamo invece utilizzando un command handler, che la chiama in modo simile internamente ad MTA.
</p><p>Ad esempio: se qualcuno durante il gioco scrivesse "createvehicle 468" nella console per spawnare una Sanchez, il command handler chiamerebbe la funzione createVehicleForPlayer, come se avessimo avuto questa riga di codice nello script:
</p>
<pre class="prettyprint lang-lua">createVehicleForPlayer(thePlayer,"createvehicle","468") -- thePlayer è l'identificatore del giocatore che ha chiamato la funzione
</pre>
<p>Come possiamo vedere, contiene diversi argomenti: il giocatore che ha chiamato il comando, il comando che ha chiamato e tutto ciò che ha scritto dopo di esso, in questo caso "468" come ID per il veicolo da spawnare, una Sanchez. I primi due parametri sono gli stessi in tutti i command handlers, come puoi vedere nella pagina <a href="https://wiki.multitheftauto.com/index.php?title=IT/addEventHandler&amp;action=edit&amp;redlink=1" class="new" title="IT/addEventHandler (page does not exist)">addEventHandler</a>. Per questo, devi per forza definire almeno questi due parametri prima che MTA possa riconoscerne altri aggiuntivi(ad esempio, in questo caso, l'ID del veicolo).
</p><p><i>Nota: Puoi creare un command handler solo DOPO aver creato la funzione che l'handler chiamerà, altrimenti MTA non troverà la funzione e non potrà quindi eseguirla.</i>
</p>
<h4><span class="mw-headline" id="Programmare_la_funzione">Programmare la funzione</span></h4>
<p>Prima di creare la funzione che utilizzeremo per il comando, dobbiamo pensare a cosa abbiamo in mente di fare:
</p>
<ul><li>Memorizzare la posizione del giocatore, in modo da sapere dove far spawnare il veicolo (vogliamo che gli appaia vicino);</li>
<li>Calcolare la posizione in cui far spawnare il veicolo (non vogliamo che appaia <i>addosso</i> al giocatore);</li>
<li>Spawnare il veicolo;</li>
<li>Controllare se l'operazione ha avuto successo, altrimenti inviare un messaggio di errore.</li></ul>
<p>Per raggiungere i nostri obiettivi dovremo usare molte funzioni. Per capire quali funzioni usare, andiamo alla <a href="https://wiki.multitheftauto.com/index.php?title=IT/Funzioni_Server-side&amp;action=edit&amp;redlink=1" class="new" title="IT/Funzioni Server-side (page does not exist)">Lista funzioni Server-side</a>. Innanzitutto ci serve una funzione per ottenere la posizione del giocatore. Dato che i giocatori sono conteggiati come <i>Elements</i>(Elementi), andiamo alla sezione <b>Funzioni sugli elementi</b> dove troveremo la funzione <a href="https://wiki.multitheftauto.com/index.php?title=IT/getElementPosition&amp;action=edit&amp;redlink=1" class="new" title="IT/getElementPosition (page does not exist)">getElementPosition</a>. Cliccando il nome della funzione nella lista raggiungeremo la pagina sui dettagli, dove potremo vedere la sintassi, un esempio di uso e il valore che la funzione ritorna. La sintassi ci mostra quali parametri possiamo o dobbiamo inserire nella funzione.
</p><p>Per la funzione <a href="https://wiki.multitheftauto.com/index.php?title=IT/getElementPosition&amp;action=edit&amp;redlink=1" class="new" title="IT/getElementPosition (page does not exist)">getElementPosition</a>, la sintassi è:
</p>
<pre class="prettyprint lang-lua">float, float, float getElementPosition ( element theElement )
</pre>
<p>I tre <i>float</i> prima del nome della funzione sono i tipi di valore che essa ritorna, in questo caso tre numeri decimali. Dentro le parentesi possiamo invece vedere gli elementi che la funzione accetta, in questo caso solo l'elemento del quale vogliamo conoscere la posizione.
</p>
<pre class="prettyprint lang-lua">function createVehicleForPlayer(thePlayer, command, vehicleModel)
	-- Ottiene le coordinate del giocatore e le memorizza nelle variabili x,y,z.
	-- (local indica che le variabili esisteranno solo all'interno dello ''scope'' corrente, in questo caso, la funzione)
	local x,y,z = getElementPosition(thePlayer)
end
</pre>
<p>Ora, vogliamo assicurarci che il veicolo non compaia direttamente sopra o nel giocatore, aggiungeremo quindi qualche unità alla variabile <i>x</i>, in modo da farlo comparire un pò più ad est del giocatore.
</p>
<pre class="prettyprint lang-lua">function createVehicleForPlayer(thePlayer, command, vehicleModel)
	local x,y,z = getElementPosition(thePlayer) -- otteniamo la posizione del giocatore
	x = x + 5 -- aggiungiamo 5 unità alla variabile x
end
</pre>
<p>Ora abbiamo bisogno di un'altra funzione, che ci permetta di spawnare il veicolo. Cerchiamola nuovamente nella <a href="https://wiki.multitheftauto.com/index.php?title=IT/Funzioni_Server-side&amp;action=edit&amp;redlink=1" class="new" title="IT/Funzioni Server-side (page does not exist)">Lista funzioni Server-side</a>, questa volta tra le <b>Funzioni per veicoli</b>, dove sceglieremo <a href="https://wiki.multitheftauto.com/index.php?title=IT/createVehicle&amp;action=edit&amp;redlink=1" class="new" title="IT/createVehicle (page does not exist)">createVehicle</a>. Nella sintassi di questa funzione abbiamo solo un valore di ritorno (più comune rispetto alle funzioni che ritornano più di un valore), cioé un elemento veicolo che indica il veicolo che abbiamo appena creato con la funzione stessa. Inoltre, vediamo che alcuni elementi si trovano tra parentesi quadre, ad indicare che essi sono opzionali.
</p><p>Abbiamo già tutti gli elementi che ci servono per chiamare <a href="https://wiki.multitheftauto.com/index.php?title=IT/createVehicle&amp;action=edit&amp;redlink=1" class="new" title="IT/createVehicle (page does not exist)">createVehicle</a> nella nostra funzione: le coordinate che abbiamo memorizzato nelle variabili <i>x,y,z</i> e l'ID del veicolo che vogliamo chiamare, ottenuto tramite il comando ("createvehicle 468") ed a cui possiamo accedere tramite la variabile locale <i>vehicleModel</i>
</p>
<pre class="prettyprint lang-lua">function createVehicleForPlayer(thePlayer, command, vehicleModel)
	local x,y,z = getElementPosition(thePlayer) -- otteniamo la posizione del giocatore
	x = x + 5 -- aggiungiamo 5 unità alla variabile x
	-- creiamo il veicolo e lo memorizziamo nella variabile ''createdVehicle''
	local createdVehicle = createVehicle(tonumber(vehicleModel),x,y,z)
end
</pre>
<p>Ovviamente questo codice otrebbe essere migliorato in molti modi, ma per il momento ci limiteremo ad aggiungere un controllo per verificare che il veicolo sia stato creato correttamente. Come possiamo leggere nella pagina <a href="https://wiki.multitheftauto.com/index.php?title=IT/createVehicle&amp;action=edit&amp;redlink=1" class="new" title="IT/createVehicle (page does not exist)">createVehicle</a> sotto <b>Valori di ritorno</b>, la funzione restituisce <i>false</i> quando non riesce a creare il veicolo. Controlleremo quindi il valore della variabile <i>createVehicle</i>.
</p><p>Ecco il nostro script completo:
</p>
<pre class="prettyprint lang-lua">function createVehicleForPlayer(thePlayer, command, vehicleModel)
	local x,y,z = getElementPosition(thePlayer) -- otteniamo la posizione del giocatore
	x = x + 5 -- aggiungiamo 5 unità alla variabile x
	local createdVehicle = createVehicle(tonumber(vehicleModel),x,y,z)
	-- controlliamo se la funzione ha restituito valore "false"
	if (createdVehicle == false) then
		-- se si, inviamo un messaggio nella chat, ma solo al giocatore che ha chiamato il comando.
		outputChatBox("Fallimento nella creazione del veicolo.",thePlayer)
	end
end
addCommandHandler("createvehicle", createVehicleForPlayer)
</pre>
<p>Come possiamo vedere, abbiamo inserito una nuova funzione: <a href="https://wiki.multitheftauto.com/index.php?title=IT/outputChatBox&amp;action=edit&amp;redlink=1" class="new" title="IT/outputChatBox (page does not exist)">outputChatBox</a>. Adesso dovresti essere in grado di navigare tra le funzioni e documentarti su di esse da te.
</p>
<h2><span id="Cosa_c.27.C3.A8_da_sapere"></span><span class="mw-headline" id="Cosa_c'è_da_sapere">Cosa c'è da sapere</span></h2>
<p>Abbiamo già letto qualcosa sulle <i>resources</i>, sui command handlers e sulle funzioni nel primo paragrafo, ma c'è ancora molto da imparare. Questa sezione ti darà qualche delucidazione su alcuni altri elementi del LUA, e dove possibile ti verranno linkate le pagine sugli argomenti in questione.
</p>
<h3><span class="mw-headline" id="Scripts_client-side_e_scripts_server-side">Scripts client-side e scripts server-side</span></h3>
<p>Avrai probabilmente già sentito i termini Server e Client da qualche parte in questa wiki, soprattutto parlando delle funzioni. MTA non supporta solo funzioni o comandi (come quello visto sopra) che funzionano su server, ma anche scripts che vengono eseguiti dal client di MTA. Il motivo di ciò è che alcune funzioni che MTA fornisce (come l'interfaccia grafica, la <i>GUI</i> - Graphical User Interface) possono essere eseguite solo dal client.
</p><p>La maggior parte degli scripts che creerai (gamemodes, e mappe) saranno probabilmente server-side, come quello che abbiamo creato nella sezione precedente. Se però ti imbatterai in qualcosa che non funzionerà sul server, dovrai ricorrere agli script client-side. Per creare uno script client-side devi creare un nuovo file .lua (ad esempio <i>client.lua</i>), come per quelli server-side e specificarlo nel <i>meta.xml</i>, in questo modo:
</p>
<pre class="prettyprint lang-xml">&lt;script src="client.lua" type="client" /&gt;
</pre>
<p>L'attributo <i>type</i> di default è impostato sempre a <i>server</i>, quindi avrai bisogno di specificarlo solo per gli script client-side. Quando fai ciò, lo script viene scaricato nel PC del client quando esso si connette al server. Per saperne di più vedi la <a href="Funzioni_Client-side.html" title="IT/Funzioni Client-side">Lista funzioni Client-side</a>.
</p>
<h3><span id="Script_pi.C3.B9_complessi"></span><span class="mw-headline" id="Script_più_complessi">Script più complessi</span></h3>
<p>La sezione precedente spiegava in breve come aggiungere script client-side alla <i>Resource</i>, ma si può fare molto di più. Come è spiegato a inizio pagina, con le <i>resource</i> si può fare praticamente tutto. Il loro scopo dipende semplicemente da ciò che fanno. Prendiamo alcune <i>resource</i> d'esempio, esaminando i file che contengono, il <i>meta.xml</i> e cosa dovrebbero fare:
</p>
<h4><span class="mw-headline" id="Primo_esempio_-_Un_utility_script">Primo esempio - Un <i>utility</i> script</span></h4>
<pre class="prettyprint lang-xml">/comandi_admin
	/meta.xml
	/comandi.lua
	/client.lua
</pre>
<pre class="prettyprint lang-xml">&lt;meta&gt;
	&lt;info author="Qualcuno" description="Comandi admin" /&gt;
	&lt;script src="comandi.lua" /&gt;
	&lt;script src="client.lua" type="client" /&gt;
&lt;/meta&gt;
</pre>
<ul><li><i>comandi.lua</i> contiene dei comandi che un admin potrà usare nel suo server per bannare i players, mutarli, o qualsiasi altra cosa</li>
<li><i>client.lua</i> contiene una finestra GUI per rendere tutto più gradevole alla vista e, soprattutto, agevole</li></ul>
<p>Questo script di esempio potrebbe restare sempre attivo (magari anche auto-avviato allo <i>startup</i> del server) perchè è utile durante ogni fase di gioco e non interferisce con la gamemode, a meno che un admin decida di togliere alcune azioni, ovviamente.
</p>
<h4><span class="mw-headline" id="Secondo_esempio_-_Una_gamemode">Secondo esempio - Una gamemode</span></h4>
<pre class="prettyprint lang-xml">/counterstrike
	/meta.xml
	/counterstrike.lua
	/buymenu.lua
</pre>
<pre class="prettyprint lang-xml">&lt;meta&gt;
	&lt;info author="Qualcuno" description="Counterstrike remake" type="gamemode" /&gt;
	&lt;script src="counterstrike.lua" /&gt;
	&lt;script src="buymenu.lua" type="client" /&gt;
&lt;/meta&gt;
</pre>
<ul><li><i>counterstrike.lua</i> contiene <i>features</i> simili a queste:
<ul><li>Far scegliere ai players il loro team e spawnarli</li>
<li>Dargli delle armi, e assegnarli degli obiettivi, magari con una mappa (vedi sotto)</li>
<li>Definire le regole del gioco, per esempio quando finisce un round o cosa succede quando un player muore</li>
<li>.. e magari qualcos'altro</li></ul></li>
<li><i>buymenu.lua</i> è uno script client-side e crea un menu GUI per comprare le armi</li></ul>
<p>Questo esempio può essere chiamato <i>gamemode</i> perchè non solo interferisce con il gioco, ma ne detta anche le regole. L'attributo <i>type</i> indica che questo esempio funzionerà con il <a href="Map_manager.html" class="mw-redirect" title="IT/Map manager">Map manager</a>, un'altra <i>resource</i> ancora creata dal QA team per gestire le gamemode e le mappe a loro associate. È fortemente raccomandato basare la gamemode sulle tecniche che il Map Manager fornisce.
</p><p>Ciò significa anche che la gamemode probabilmente non girerà senza una mappa. Le gamemode, infatti, dovrebbero essere più generiche possibile. Un esempio per una mappa si può trovare qui sotto.
</p>
<h4><span class="mw-headline" id="Terzo_esempio_-_Una_mappa">Terzo esempio - Una mappa</span></h4>
<pre class="prettyprint lang-xml">/cs-airport
	/meta.xml
	/airport.map
	/airport.lua
</pre>
<pre class="prettyprint lang-xml">&lt;meta&gt;
	&lt;info author="Qualcuno" description="Counterstrike airport map" type="map" gamemodes="counterstrike" /&gt;
	&lt;map src="airport.map" /&gt;
	&lt;script src="airport.lua" /&gt;
&lt;/meta&gt;
</pre>
<ul><li><i>airport.map</i> è un file XML che fornisce alla mode informazioni sulla mappa, come:
<ul><li>I punti di spawn dei players, le loro armi, i team</li>
<li>Gli obiettivi</li>
<li>Il tempo atmosferico, l'ora del giorno, il limite di tempo</li>
<li>I veicoli e gli oggetti</li></ul></li>
<li><i>airport.lua</i> potrebbe contenere alcune <i>feature</i> specifiche di una mappa:
<ul><li>Aprire una porta/fare qualcosa di speciale quando accade un evento particolare</li>
<li>Creare e muovere oggetti personalizzati, o manipolare gli oggetti creati con il file .map</li>
<li>.. qualunque altra cosa specifica di una mappa</li></ul></li></ul>
<p>Come potete vedere, l'attributo <i>type</i> è diventato 'map', per avvertire il <a href="Map_manager.html" class="mw-redirect" title="IT/Map manager">Map manager</a> che questa <i>resource</i> è una mappa, mentre l'attributo <i>gamemodes</i> imposta le gamemode compatibili con questa mappa, in questo caso la gamemode dell'esempio precedente.
Ciò che potrebbe sembrare strano è uno script LUA in una mappa. Ovviamente non sempre serve, ma offre a chi crea una mappa la possibilità di creare un vero e proprio mondo con le regole imposte dalla gamemode.
</p><p>Il file <i>airport.map</i> potrebbe somigliare a questo:
</p>
<pre class="prettyprint lang-xml">&lt;map mode="deathmatch" version="1.0"&gt;
	&lt;terrorists&gt;
		&lt;spawnpoint posX="2332.23" posY="-12232.33" posZ="4.42223" skins="23-40" /&gt;
	&lt;/terrorists&gt;
	&lt;counterterrorists&gt;
		&lt;spawnpoint posX="2334.23443" posY="-12300.233" posZ="10.2344" skins="40-50" /&gt;
	&lt;/counterterrorists&gt;

	&lt;bomb posX="23342.23" posY="" posZ="" /&gt;
	
	&lt;vehicle posX="" posY="" posZ="" model="602" /&gt;	
	&lt;vehicle posX="" posY="" posZ="" model="603" /&gt;	
&lt;/map&gt;
</pre>
<p>Quando una gamemode con una mappa compatibile è avviata, la <i>resource</i> della mappa viene automaticamente avviata dal mapmanager, che permette alla gamemode di <i>leggere</i> le informazioni che contiene. Quando la mappa cambia, la <i>resource</i> della mappa precedente viene fermata automaticamente e viene avviata quella successiva.
</p>
<h3><span class="mw-headline" id="Eventi">Eventi</span></h3>
<p>Gli eventi sono il mezzo con cui MTA comunica agli script ciò che sta accadendo nel gioco. Per esempio, quando un player muore, viene chiamato l'evento <a href="https://wiki.multitheftauto.com/index.php?title=IT/onPlayerWasted&amp;action=edit&amp;redlink=1" class="new" title="IT/onPlayerWasted (page does not exist)">onPlayerWasted</a>. Per eseguire qualsiasi azione quando un player muore, devi imparare a creare degli <i>event handlers</i>, com'è spiegato nel <a href="#Scrivere_uno_script">primo capitolo</a>.
</p><p>Questo esempio scriverà nella chatbox il nome del player che è morto:
</p>
<pre class="prettyprint lang-lua">function playerDied(totalAmmo, killer, killerWeapon, bodypart)
	outputChatBox(getPlayerName(source).." è morto!")
end
addEventHandler("onPlayerWasted",getRootElement(),playerDied)
</pre>
<p>Al posto di mostrare quali argomenti servono, la pagina di documentazione per gli eventi mostra quali parametri sono passati alla funzione a cui un evento è <i>legato</i> (come playerDied nell'esempio di prima), come fa un <a href="#A_proposito_dei_command_handlers">command handler</a>, solo che è diverso da evento a evento. Un altro punto importante è la variabile <i>source</i>, che si trova nelle funzioni chiamate da un <i>event handler</i>. Non ha bisogno di essere aggiunto nella lista di parametri della funzione, ma esiste lo stesso. Ha valori differenti da evento a evento, per gli eventi che riguardano un player (come nell'esempio di sopra) di solito è l'elemento <i>player</i>.
</p>
<h2><span class="mw-headline" id="Cosa_fare_dopo">Cosa fare dopo</span></h2>
<p>Ora dovresti essere pratico con le basi dello scripting per MTA e anche un po' con la documentazione. La <a href="Pagina_principale.html" title="IT/Pagina principale">Pagina principale</a> ti fornisce link a informazioni, tutorial e riferimenti che permettono di scoprire più a fondo gli argomenti che vuoi imparare.
</p>
<!-- 
NewPP limit report
Cached time: 20220727053804
Cache expiry: 86400
Reduced expiry: false
Complications: []
CPU time usage: 0.014 seconds
Real time usage: 0.015 seconds
Preprocessor visited node count: 162/1000000
Post‐expand include size: 384/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/100
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 4512/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.689      1 Template:IT/MainP
100.00%    0.689      1 -total
-->

<!-- Saved in parser cache with key wiki-wiki_dev_:pcache:idhash:3668-0!canonical and timestamp 20220727053804 and revision id 21332. Serialized with JSON.
 -->
</div>
<div class="printfooter">Retrieved from "<a dir="ltr" href="https://wiki.multitheftauto.com/index.php?title=IT/Introduzione_allo_scripting&amp;oldid=21332">https://wiki.multitheftauto.com/index.php?title=IT/Introduzione_allo_scripting&amp;oldid=21332</a>"</div></div>
		<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="../Special_Categories.html" title="Special:Categories">Categories</a>: <ul><li><a href="../Category_IT/Pagine_italiane.html" title="Category:IT/Pagine italiane">IT/Pagine italiane</a></li><li><a href="../Category_100%25.html" title="Category:100%">100%</a></li><li><a href="../Category_IT/Concetti_di_scripting.html" title="Category:IT/Concetti di scripting">IT/Concetti di scripting</a></li><li><a href="../Category_IT/Guide_e_tutorial.html" title="Category:IT/Guide e tutorial">IT/Guide e tutorial</a></li></ul></div></div>
	</div>
</div>

<div id="mw-navigation">
	<h2>Navigation menu</h2>
	<div id="mw-head">
		
<nav id="p-personal" class="mw-portlet mw-portlet-personal vector-user-menu-legacy vector-menu" aria-labelledby="p-personal-label" role="navigation" 
	 >
	<label id="p-personal-label" aria-label="" class="vector-menu-heading">
		<span class="vector-menu-heading-label">Personal tools</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="pt-createaccount" class="mw-list-item"><a href="https://wiki.multitheftauto.com/index.php?title=Special:CreateAccount&amp;returnto=IT%2FIntroduzione+allo+scripting" title="You are encouraged to create an account and log in; however, it is not mandatory"><span>Create account</span></a></li><li id="pt-login" class="mw-list-item"><a href="https://wiki.multitheftauto.com/index.php?title=Special:UserLogin&amp;returnto=IT%2FIntroduzione+allo+scripting" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o"><span>Log in</span></a></li></ul>
		
	</div>
</nav>

		<div id="left-navigation">
			
<nav id="p-namespaces" class="mw-portlet mw-portlet-namespaces vector-menu vector-menu-tabs" aria-labelledby="p-namespaces-label" role="navigation" 
	 >
	<label id="p-namespaces-label" aria-label="" class="vector-menu-heading">
		<span class="vector-menu-heading-label">Namespaces</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="ca-nstab-main" class="selected mw-list-item"><a href="Introduzione_allo_scripting.html" title="View the content page [c]" accesskey="c"><span>Page</span></a></li><li id="ca-talk" class="mw-list-item"><a href="../Talk_IT/Introduzione_allo_scripting.html" rel="discussion" title="Discussion about the content page [t]" accesskey="t"><span>Discussion</span></a></li></ul>
		
	</div>
</nav>

			
<nav id="p-variants" class="mw-portlet mw-portlet-variants emptyPortlet vector-menu-dropdown-noicon vector-menu vector-menu-dropdown" aria-labelledby="p-variants-label" role="navigation" 
	 >
	<input type="checkbox"
		id="p-variants-checkbox"
		role="button"
		aria-haspopup="true"
		data-event-name="ui.dropdown-p-variants"
		class="vector-menu-checkbox" aria-labelledby="p-variants-label" />
	<label id="p-variants-label" aria-label="Change language variant" class="vector-menu-heading">
		<span class="vector-menu-heading-label">English</span>
			<span class="vector-menu-checkbox-expanded">expanded</span>
			<span class="vector-menu-checkbox-collapsed">collapsed</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</nav>

		</div>
		<div id="right-navigation">
			
<nav id="p-views" class="mw-portlet mw-portlet-views vector-menu vector-menu-tabs" aria-labelledby="p-views-label" role="navigation" 
	 >
	<label id="p-views-label" aria-label="" class="vector-menu-heading">
		<span class="vector-menu-heading-label">Views</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="ca-view" class="selected mw-list-item"><a href="Introduzione_allo_scripting.html"><span>Read</span></a></li><li id="ca-viewsource" class="mw-list-item"><a href="https://wiki.multitheftauto.com/index.php?title=IT/Introduzione_allo_scripting&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e"><span>View source</span></a></li><li id="ca-history" class="mw-list-item"><a href="https://wiki.multitheftauto.com/index.php?title=IT/Introduzione_allo_scripting&amp;action=history" title="Past revisions of this page [h]" accesskey="h"><span>View history</span></a></li></ul>
		
	</div>
</nav>

			
<nav id="p-cactions" class="mw-portlet mw-portlet-cactions emptyPortlet vector-menu-dropdown-noicon vector-menu vector-menu-dropdown" aria-labelledby="p-cactions-label" role="navigation"  title="More options"
	 >
	<input type="checkbox"
		id="p-cactions-checkbox"
		role="button"
		aria-haspopup="true"
		data-event-name="ui.dropdown-p-cactions"
		class="vector-menu-checkbox" aria-labelledby="p-cactions-label" />
	<label id="p-cactions-label" aria-label="" class="vector-menu-heading">
		<span class="vector-menu-heading-label">More</span>
			<span class="vector-menu-checkbox-expanded">expanded</span>
			<span class="vector-menu-checkbox-collapsed">collapsed</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</nav>

			
<div id="p-search" role="search" class="vector-search-box-vue  vector-search-box-show-thumbnail vector-search-box-auto-expand-width vector-search-box">
	<div>
			<h3 >
				<label for="searchInput">Search</label>
			</h3>
		<form action="https://wiki.multitheftauto.com/index.php" id="searchform"
			class="vector-search-box-form">
			<div id="simpleSearch"
				class="vector-search-box-inner"
				 data-search-loc="header-navigation">
				<input class="vector-search-box-input"
					 type="search" name="search" placeholder="Search Multi Theft Auto: Wiki" aria-label="Search Multi Theft Auto: Wiki" autocapitalize="sentences" title="Search Multi Theft Auto: Wiki [f]" accesskey="f" id="searchInput"
				/>
				<input type="hidden" name="title" value="Special:Search"/>
				<input id="mw-searchButton"
					 class="searchButton mw-fallbackSearchButton" type="submit" name="fulltext" title="Search the pages for this text" value="Search" />
				<input id="searchButton"
					 class="searchButton" type="submit" name="go" title="Go to a page with this exact name if it exists" value="Go" />
			</div>
		</form>
	</div>
</div>

		</div>
	</div>
	

<div id="mw-panel">
	<div id="p-logo" role="banner">
		<a class="mw-wiki-logo" href="../Main_Page.html"
			title="Visit the main page"></a>
	</div>
	
<nav id="p-navigation" class="mw-portlet mw-portlet-navigation vector-menu vector-menu-portal portal" aria-labelledby="p-navigation-label" role="navigation" 
	 >
	<label id="p-navigation-label" aria-label="" class="vector-menu-heading">
		<span class="vector-menu-heading-label">Navigation</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="n-Home" class="mw-list-item"><a href="../Main_Page.html"><span>Home</span></a></li><li id="n-How-you-can-help" class="mw-list-item"><a href="../How_you_can_help.html"><span>How you can help</span></a></li><li id="n-recentchanges" class="mw-list-item"><a href="../Special_RecentChanges.html" icon="recentChanges" title="A list of recent changes in the wiki [r]" accesskey="r"><span>Recent changes</span></a></li><li id="n-randompage" class="mw-list-item"><a href="../DgsGridListSetItemSelectable.html" icon="die" title="Load a random page [x]" accesskey="x"><span>Random page</span></a></li></ul>
		
	</div>
</nav>

	
<nav id="p-Reference" class="mw-portlet mw-portlet-Reference vector-menu vector-menu-portal portal" aria-labelledby="p-Reference-label" role="navigation" 
	 >
	<label id="p-Reference-label" aria-label="" class="vector-menu-heading">
		<span class="vector-menu-heading-label">Reference</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="n-Client-Functions" class="mw-list-item"><a href="../Client_Scripting_Functions.html"><span>Client Functions</span></a></li><li id="n-Client-Events" class="mw-list-item"><a href="../Client_Scripting_Events.html"><span>Client Events</span></a></li><li id="n-Server-Functions" class="mw-list-item"><a href="../Server_Scripting_Functions.html"><span>Server Functions</span></a></li><li id="n-Server-Events" class="mw-list-item"><a href="../Server_Scripting_Events.html"><span>Server Events</span></a></li><li id="n-Shared-Functions" class="mw-list-item"><a href="../Shared_Scripting_Functions.html"><span>Shared Functions</span></a></li><li id="n-Useful-Functions" class="mw-list-item"><a href="../Useful_Functions.html"><span>Useful Functions</span></a></li><li id="n-MTA-Classes" class="mw-list-item"><a href="../MTA_Classes.html"><span>MTA Classes</span></a></li><li id="n-MTA-Elements" class="mw-list-item"><a href="../Element.html"><span>MTA Elements</span></a></li><li id="n-Element-Tree" class="mw-list-item"><a href="../Element_tree.html"><span>Element Tree</span></a></li></ul>
		
	</div>
</nav>

<nav id="p-tb" class="mw-portlet mw-portlet-tb vector-menu vector-menu-portal portal" aria-labelledby="p-tb-label" role="navigation" 
	 >
	<label id="p-tb-label" aria-label="" class="vector-menu-heading">
		<span class="vector-menu-heading-label">Tools</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="t-whatlinkshere" class="mw-list-item"><a href="../Special_WhatLinksHere/IT/Introduzione_allo_scripting.html" title="A list of all wiki pages that link here [j]" accesskey="j"><span>What links here</span></a></li><li id="t-recentchangeslinked" class="mw-list-item"><a href="../Special_RecentChangesLinked/IT/Introduzione_allo_scripting.html" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k"><span>Related changes</span></a></li><li id="t-specialpages" class="mw-list-item"><a href="../Special_SpecialPages.html" title="A list of all special pages [q]" accesskey="q"><span>Special pages</span></a></li><li id="t-print" class="mw-list-item"><a href="javascript:print();" rel="alternate" title="Printable version of this page [p]" accesskey="p"><span>Printable version</span></a></li><li id="t-permalink" class="mw-list-item"><a href="https://wiki.multitheftauto.com/index.php?title=IT/Introduzione_allo_scripting&amp;oldid=21332" title="Permanent link to this revision of the page"><span>Permanent link</span></a></li><li id="t-info" class="mw-list-item"><a href="https://wiki.multitheftauto.com/index.php?title=IT/Introduzione_allo_scripting&amp;action=info" title="More information about this page"><span>Page information</span></a></li></ul>
		
	</div>
</nav>

	
<nav id="p-lang" class="mw-portlet mw-portlet-lang vector-menu vector-menu-portal portal" aria-labelledby="p-lang-label" role="navigation" 
	 >
	<label id="p-lang-label" aria-label="" class="vector-menu-heading">
		<span class="vector-menu-heading-label">In other languages</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li class="interlanguage-link interwiki-ru mw-list-item"><a href="http://wiki.multitheftauto.com/index.php?title=RU/Scripting_Introduction" title="Scripting Introduction – русский" lang="ru" hreflang="ru" class="interlanguage-link-target"><span>Русский</span></a></li><li class="interlanguage-link interwiki-en mw-list-item"><a href="http://wiki.multitheftauto.com/index.php?title=Scripting_Introduction" title="Scripting Introduction – English" lang="en" hreflang="en" class="interlanguage-link-target"><span>English</span></a></li></ul>
		
	</div>
</nav>

</div>

</div>

<footer id="footer" class="mw-footer" role="contentinfo" >
	<ul id="footer-info">
	<li id="footer-info-lastmod"> This page was last edited on 27 August 2009, at 12:30.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/licenses/fdl-1.3.html">GNU Free Documentation License 1.3</a> unless otherwise noted.</li>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="../Multi_Theft_Auto__Wiki_Privacy_policy.html" title="Multi Theft Auto: Wiki:Privacy policy">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../Multi_Theft_Auto__Wiki_About.html" title="Multi Theft Auto: Wiki:About">About Multi Theft Auto: Wiki</a></li>
	<li id="footer-places-disclaimer"><a href="../Multi_Theft_Auto__Wiki_General_disclaimer.html" title="Multi Theft Auto: Wiki:General disclaimer">Disclaimers</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/licenses/fdl-1.3.html"><img src="https://wiki.multitheftauto.com/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3" width="88" height="31" loading="lazy"/></a></li>
	<li id="footer-poweredbyico"><a href="https://www.mediawiki.org/"><img src="https://wiki.multitheftauto.com/resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"/></a></li>
</ul>

</footer>

<script src="https://wiki.multitheftauto.com/extensions/_MTAThemeExtensions/main.js"></script><script src="https://wiki.multitheftauto.com/extensions/_MTAThemeExtensions/topmenu.js"></script>
<script>(RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgPageParseReport":{"limitreport":{"cputime":"0.014","walltime":"0.015","ppvisitednodes":{"value":162,"limit":1000000},"postexpandincludesize":{"value":384,"limit":2097152},"templateargumentsize":{"value":0,"limit":2097152},"expansiondepth":{"value":2,"limit":100},"expensivefunctioncount":{"value":0,"limit":100},"unstrip-depth":{"value":0,"limit":20},"unstrip-size":{"value":4512,"limit":5000000},"timingprofile":["100.00%    0.689      1 Template:IT/MainP","100.00%    0.689      1 -total"]},"cachereport":{"timestamp":"20220727053804","ttl":86400,"transientcontent":false}}});mw.config.set({"wgBackendResponseTime":77});});</script>
</body>
</html>