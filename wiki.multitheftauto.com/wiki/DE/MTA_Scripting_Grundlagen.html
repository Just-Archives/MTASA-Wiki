<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8"/>
<title>DE/MTA Scripting Grundlagen - Multi Theft Auto: Wiki</title>
<script>document.documentElement.className="client-js";RLCONF={"wgBreakFrames":true,"wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgRequestId":"32ffc3ef9e35ef73ebd519ad","wgCSPNonce":false,"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"DE/MTA_Scripting_Grundlagen","wgTitle":"DE/MTA Scripting Grundlagen","wgCurRevisionId":54097,"wgRevisionId":54097,"wgArticleId":4830,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgRelevantPageName":"DE/MTA_Scripting_Grundlagen","wgRelevantArticleId":4830,"wgIsProbablyEditable":false,"wgRelevantPageIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[]};RLSTATE={"site.styles":"ready",
"user.styles":"ready","user":"ready","user.options":"loading","skins.vector.styles.legacy":"ready"};RLPAGEMODULES=["site","mediawiki.page.ready","mediawiki.toc","skins.vector.legacy.html","ext.GoogleCodePrettify","ext.gadget.ReferenceTooltips","ext.gadget.exlinks","ext.gadget.DotsSyntaxHighlighter","ext.gadget.purgetab","ext.gadget.markblocked"];</script>
<script>(RLQ=window.RLQ||[]).push(function(){mw.loader.implement("user.options@1i9g4",function($,jQuery,require,module){mw.user.tokens.set({"patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});});});</script>
<link rel="stylesheet" href="https://wiki.multitheftauto.com/load.php?lang=en&amp;modules=skins.vector.styles.legacy&amp;only=styles&amp;skin=vector"/>
<script async="" src="https://wiki.multitheftauto.com/load.php?lang=en&amp;modules=startup&amp;only=scripts&amp;raw=1&amp;skin=vector"></script>
<meta name="generator" content="MediaWiki 1.38.2"/>
<meta name="format-detection" content="telephone=no"/>
<link href="../../extensions/_MTAThemeExtensions/custom.css" rel="stylesheet"/>
<link rel="shortcut icon" href="https://wiki.multitheftauto.com/favicon.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="https://wiki.multitheftauto.com/opensearch_desc.php" title="Multi Theft Auto: Wiki (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.multitheftauto.com/api.php?action=rsd"/>
<link rel="license" href="https://www.gnu.org/licenses/fdl-1.3.html"/>
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-DE_MTA_Scripting_Grundlagen rootpage-DE_MTA_Scripting_Grundlagen skin-vector action-view skin-vector-legacy"><div id="mw-page-base" class="noprint"></div>
<div id="mw-head-base" class="noprint"></div>
<div id="content" class="mw-body" role="main">
	<a id="top"></a>
	<div id="siteNotice"></div>
	<div class="mw-indicators">
	</div>
	<h1 id="firstHeading" class="firstHeading mw-first-heading">DE/MTA Scripting Grundlagen</h1>
	<div id="bodyContent" class="vector-body">
		<div id="siteSub" class="noprint">From Multi Theft Auto: Wiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" class="mw-body-content mw-content-ltr" lang="en" dir="ltr"><div class="mw-parser-output"><div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading"><input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none" /><div class="toctitle" lang="en" dir="ltr"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Vorwort"><span class="tocnumber">1</span> <span class="toctext">Vorwort</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Grundlagen"><span class="tocnumber">2</span> <span class="toctext">Grundlagen</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Meta.xml"><span class="tocnumber">3</span> <span class="toctext">Meta.xml</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Sinn_und_Zweck"><span class="tocnumber">3.1</span> <span class="toctext">Sinn und Zweck</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Mögliche_Tags"><span class="tocnumber">3.2</span> <span class="toctext">Mögliche Tags</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Beispiel"><span class="tocnumber">3.3</span> <span class="toctext">Beispiel</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-7"><a href="#Elemente"><span class="tocnumber">4</span> <span class="toctext">Elemente</span></a>
<ul>
<li class="toclevel-2 tocsection-8"><a href="#Was_sind_Elemente?"><span class="tocnumber">4.1</span> <span class="toctext">Was sind Elemente?</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Der_Elementbaum"><span class="tocnumber">4.2</span> <span class="toctext">Der Elementbaum</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Elemente_in_MTA-Funktionen"><span class="tocnumber">4.3</span> <span class="toctext">Elemente in MTA-Funktionen</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-11"><a href="#Events"><span class="tocnumber">5</span> <span class="toctext">Events</span></a>
<ul>
<li class="toclevel-2 tocsection-12"><a href="#Beschreibung"><span class="tocnumber">5.1</span> <span class="toctext">Beschreibung</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#Serverseitiges_Beispiel"><span class="tocnumber">5.2</span> <span class="toctext">Serverseitiges Beispiel</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-14"><a href="#Commands"><span class="tocnumber">6</span> <span class="toctext">Commands</span></a>
<ul>
<li class="toclevel-2 tocsection-15"><a href="#Beschreibung_2"><span class="tocnumber">6.1</span> <span class="toctext">Beschreibung</span></a></li>
<li class="toclevel-2 tocsection-16"><a href="#Serverseitiges_Beispiel_2"><span class="tocnumber">6.2</span> <span class="toctext">Serverseitiges Beispiel</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><span class="mw-headline" id="Vorwort">Vorwort</span></h2>
<p>Nachdem ich bereits vor kurzer Zeit mein <a href="Lua_Tutorial.html" title="DE/Lua Tutorial">Lua Tutorial</a> fertiggestellt habe, folgt nun eine Einführung in die Grundlagen des MTA Scriptings, in der diesmal direkter Bezug auf MTA genommen wird.
</p><p>In Kürze wird es hier im Wiki einen blank Gamemode geben, den man sich herunterladen kann und als Basis für seinen eigenen verwenden kann. Die soll vor allem Anfängern den Einstieg in's MTA Scripting erleichtern.
</p><p><br />
</p>
<h2><span class="mw-headline" id="Grundlagen">Grundlagen</span></h2>
<p>In diesem Tutorial wird häufig die Rede von Server und Client sein. Ein Client ist quasi ein Spieler, allgemein ist damit jedoch das Programm gemeint, was der Spieler auf dem Rechner installiert hat und mit dem er MTA spielen kann. Mit Server ist einfach der MTA Server gemeint.
Die Hauptaufgabe des Servers besteht darin, Daten von allen Clients bezüglich Position usw. einzusammeln und gleichzeitig an jeweils alle anderen Clients zu verteilen. Im Gegensatz zum Client ist der Server nicht in der Lage physikalische oder graphische Effekte zu berechnen, weswegen viele Funktionen von MTA, die eines dieser beiden Bereiche beeinflussen, clientseitig sind.
</p><p>MTA unterscheidet zwischen zwei verschiedenen Ausführungsorten. D.h., dass es Scripts gibt, die vom Server ausgeführt und mit allen Clients synchronisiert werden und welche, die von jedem Client selbst ausgeführt werden und <b>nicht</b> mit allen anderen Clients synchronisiert werden.
Clientseitig bedeutet, dass etwas nur vom Client ausgeführt wird/werden kann, serverseitig, dass es nur vom Server ausgeführt wird/werden kann. Die meisten Funktionen von MTA können jedoch auf beiden Seiten ausgeführt werden.
Ziel ist es, diese Gegebenheit zu nutzen und den Server somit so gut wie möglich zu entlasten, was nicht immer einfach ist.
</p><p>Bei MTA spricht man übrigens nicht von Scripts oder Gamemodes, sondern allgemein von Ressourcen. Eine Ressource ist ein Verzeichnis mit einem oder mehreren Scripts. 
Beim Start des MTA Servers wird der ressources Ordner durchsucht und jedes Verzeichnis, dass eine gültige meta.xml enthält, der Liste der verfügbaren Ressourcen hinzugefügt.
</p><p><br />
</p>
<h2><span class="mw-headline" id="Meta.xml">Meta.xml</span></h2>
<h3><span class="mw-headline" id="Sinn_und_Zweck">Sinn und Zweck</span></h3>
<p>Die meta.xml ist eine wichtige Datei, die in jedem Ressourcenordner vorhanden sein muss, damit diese vom MTA Server erkannt wird und ausgeführt werden kann.
Sie definiert, aus welchen Dateien sich die Ressource zusammensetzt und unter anderem auch, welche dieser Dateien beim Connecten an den Client gesendet werden sollen.
</p><p>Alle Daten in der meta.xml sind im XML-Format. Ein sogenannter XML-Tag ist ein Datenset, was in etwa so aussieht:
&lt;tagname attribut="wert"&gt;inhalt&lt;/tagname&gt; oder &lt;tagname attribut="wert" /&gt;, wenn der Inhalt entfällt.
Ein XML-Tag kann beliebig viele Attribute enthalten.
</p><p>Nähere Informationen zum Thema XML entnehmt ihr aber bitte dem <a rel="nofollow" class="external text" href="http://de.wikipedia.org/wiki/Xml">Wikipedia-Artikel</a> darüber.
</p><p><br />
</p>
<h3><span id="M.C3.B6gliche_Tags"></span><span class="mw-headline" id="Mögliche_Tags">Mögliche Tags</span></h3>
<pre class="prettyprint lang-xml">&lt;info author="Autor" version="Version" name="Name" description="Beschreibung" type="Typ" /&gt;</pre>
<ul><li>Jede Ressource sollte einen info-Tag in der meta.xml enthalten. Werte des info-Tags kann man übrigens mit <a href="../GetResourceInfo.html" title="GetResourceInfo">getResourceInfo</a> auslesen.
<ul><li><b>author</b>: Das ist normalerweise der Name desjenigen, der die Ressource erstellt hat.</li>
<li><b>version</b>: Die Version der vorliegenden Ressource. Für alle, die gerne mit wahllosen Versionsnummern um sich schmeißen.</li>
<li><b>name</b>: Der Name der Ressource.</li>
<li><b>description</b>: Eine kurze Beschreibung der Ressource.</li>
<li><b>type</b>: Typ der Ressource. Kann den Wert "gamemode", "script" oder "map" enthalten.</li></ul></li></ul>
<pre class="prettyprint lang-xml">&lt;script src="Dateipfad und -name" type="Typ" /&gt;</pre>
<ul><li>Mit dem script-Tag werden Lua-Scriptdateien in die Ressource eingebunden. Das sind die wohl wichtigsten Dateien der meisten Ressourcen.
<ul><li><b>src</b>: Der Pfad zur Scriptdatei relativ zum Odner der jeweiligen Ressource mit dem Dateinamen natürlich.</li>
<li><b>type</b>: Typ des Scripts. Kann entweder "server" oder "client" sein. Bei ersterem wird das Script serverseitig ausgeführt, bei letzterem jedem Client beim Verbindungsaufbau gesendet und clientseitig ausgeführt.</li></ul></li></ul>
<pre class="prettyprint lang-xml">&lt;map src="Dateipfad und -name" /&gt;</pre>
<ul><li>Mit dem map-Tag werden Mapdateien eingebunden, die automatisch beim Ressourcenstart geladen werden. Mit den <a href="../Server_Scripting_Functions.html#Map_functions" title="Server Scripting Functions">Mapfunktionen</a> kann man nachträglich noch Maps laden. Eine Map ist übrigens eine Karte, genauer ein Set von ObjektIDs mit Koordinaten und Rotationsangaben.
<ul><li><b>src</b>: Der Pfad zur Mapdatei relativ zum Odner der jeweiligen Ressource mit dem Dateinamen natürlich.</li></ul></li></ul>
<pre class="prettyprint lang-xml">&lt;file src="Dateipfad und -name" /&gt;</pre>
<ul><li>Der file-Tag zeichnet eine beliebige Datei als clientseitig aus. Während Scripts vom Typ "client" automatisch heruntergeladen werden, werden es die darin enthaltenen Bilder, Models oder Texturen nicht. Alle Dateien, die im clientseitigen Script verwendet werden, müssen mit dem file-Tag als clientseitig ausgezeichnet werden.
<ul><li><b>src</b>: Der Pfad zur Datei relativ zum Odner der jeweiligen Ressource mit dem Dateinamen natürlich.</li></ul></li></ul>
<pre class="prettyprint lang-xml">&lt;include ressource="Ressourcenname" /&gt;</pre>
<ul><li>Manchmal möchte man, dass eine Ressource beim Start automatisch andere Ressourcen mit startet. Dies kann man mit dem include-Tag erreichen.
<ul><li><b>ressource</b>: Der Name der Ressource, d.h. der Name des Ordners, in dem die Ressource sich befindet. (Muss sich im resources-Ordner befinden.)</li></ul></li></ul>
<pre class="prettyprint lang-xml">&lt;config src="Dateipfad und -name" type="Typ" /&gt;</pre>
<ul><li>Konfigurationsdateien sind XML-Dateien, in denen bestimmte Einstellungen für einen Ressource vorgenommen werden können, auf die per Script zugegriffen werden kann. Unter den <a href="../Server_Scripting_Functions.html#Resource_functions" title="Server Scripting Functions">Ressourcenfunktionen</a> finden sich solche zum Auslesen und Ändern der Konfiguration.
<ul><li><b>src</b>: Der Pfad zur Konfigurationsdatei relativ zum Odner der jeweiligen Ressource mit dem Dateinamen natürlich.</li>
<li><b>type</b>: Typ der Konfiguration. Kann entweder "server" oder "client" sein. Bei ersterem wird die Konfigurationsdatei serverseitig eingebunden, bei letzterem jedem Client beim Verbindungsaufbau gesendet und clientseitig eingebunden.</li></ul></li></ul>
<pre class="prettyprint lang-xml">&lt;export function="Funktionsname" type="Typ" http="true/false" /&gt;</pre>
<ul><li>Den export-Tag kann man benutzen, um eine Funktion aus der aktuellen Ressource in anderen laufenden Ressourcen verfügbar zu machen.
<ul><li><b>function</b>: Der Name der Funktion.</li>
<li><b>type</b>: Typ des Exports. Kann entweder "server" oder "client" sein. Bei ersterem wird die Funktion serverseitig exportiert, bei letzterem clientseitig.</li>
<li><b>http</b>: Legt fest, ob die exportierte Funktion auch via HTTP aufgerufen werden kann. Kann demnach entweder "true" (ja) oder "false" (nein) sein.</li></ul></li></ul>
<pre class="prettyprint lang-xml">&lt;html src="Dateipfad und -name" default="true/false" raw="true/false" /&gt;</pre>
<ul><li>Wenn über MTAs eingebauten HTTP-Server Zugang zu einer im Ressourcenordner liegenden Datei ermöglichen will, so muss man diese mit dem html-Tag in der meta.xml einbinden.
<ul><li><b>src</b>: Der Pfad zur Datei relativ zum Odner der jeweiligen Ressource mit dem Dateinamen natürlich.</li>
<li><b>default</b>: Wenn das HTML-Dokument standardmäßig angezeigt werden soll, wenn über den Browser auf den Ressourcenordner zugegriffen wird, dann muss default="true" sein, ansonsten "false".</li>
<li><b>raw</b>: Wenn es sich um eine Datei im binären Format handelt, z.B. einem Bild, dann sollte raw auf "true" gesetzt werden.</li></ul></li></ul>
<pre class="prettyprint lang-xml">&lt;settings /&gt;</pre>
<p><br />
</p>
<h3><span class="mw-headline" id="Beispiel">Beispiel</span></h3>
<pre class="prettyprint lang-xml">&lt;meta&gt;
    &lt;info author="Slothman" type="gamemode" name="Stealth" /&gt;
    &lt;config src="help.xml" type="client"/&gt;

    &lt;script src="stealthmain_server.lua" /&gt;
    &lt;script src="noiseblip.lua" /&gt;
    &lt;script src="mission_timer.lua" /&gt;
    &lt;script src="gadgets_server.lua" /&gt;
    &lt;script src="gadgets_client.lua" type="client"/&gt;
    &lt;script src="stealthmain_client.lua" type="client"/&gt;
    &lt;script src="noisebar.lua" type="client"/&gt;
    &lt;script src="spycam.lua" type="client"/&gt;

    &lt;file src="riot_shield.txd" /&gt;
    &lt;file src="riot_shield.dff" /&gt;
    &lt;file src="riot_shield.col" /&gt;
    &lt;file src="armor.png" /&gt;
    &lt;file src="camera.png" /&gt;
    &lt;file src="cloak.png" /&gt;
    &lt;file src="goggles.png" /&gt;
    &lt;file src="mine.png" /&gt;
    &lt;file src="radar.png" /&gt;
    &lt;file src="shield.png" /&gt;

    &lt;include resource="scoreboard" /&gt;
    &lt;include resource="killmessages" /&gt;
    &lt;include resource="maplimits" /&gt;

    &lt;settings&gt;
     &lt;setting name="roundlimit" value="[6]" /&gt; &lt;!-- round length in minutes --&gt;
	 &lt;setting name="teamdamage" value="[1]" /&gt; &lt;!-- 0 for team protection off, 1 for team protection on --&gt;
	 &lt;setting name="teambalance" value="[1]" /&gt; &lt;!--  difference limit of amount of players between teams --&gt;
	 &lt;setting name="spazammo" value="[25]" /&gt; &lt;!-- ammo amounts --&gt;
	 &lt;setting name="m4ammo" value="[100]" /&gt;
	 &lt;setting name="shotgunammo" value="[25]" /&gt;
	 &lt;setting name="sniperammo" value="[20]" /&gt;
	 &lt;setting name="ak47ammo" value="[120]" /&gt;
	 &lt;setting name="rifleammo" value="[40]" /&gt;
	 &lt;setting name="deserteagleammo" value="[45]" /&gt;
	 &lt;setting name="pistolammo" value="[132]" /&gt;
	 &lt;setting name="uziammo" value="[150]" /&gt;
	 &lt;setting name="tec9ammo" value="[150]" /&gt;
	 &lt;setting name="silencedammo" value="[65]" /&gt;
	 &lt;setting name="grenadeammo" value="[4]" /&gt;
	 &lt;setting name="satchelammo" value="[4]" /&gt;
	 &lt;setting name="teargasammo" value="[4]" /&gt;
	 &lt;setting name="molatovammo" value="[4]" /&gt;
     &lt;/settings&gt;
&lt;/meta&gt;</pre>
<p><br />
</p>
<h2><span class="mw-headline" id="Elemente">Elemente</span></h2>
<h3><span id="Was_sind_Elemente.3F"></span><span class="mw-headline" id="Was_sind_Elemente?">Was sind Elemente?</span></h3>
<p>Ein Element in MTA kann alles sein. Sei es ein Spieler, ein Fahrzeug, ein Objekt, ein Marker, ein GUI-Element oder aber auch eine Ressource. Und das waren nicht mal alle möglichen Elementtypen.
</p><p>Im Script sind Elemente durch Userdata-Pointer vertreten. Man kann mit ihnen eigentlich nichts anderes machen, als sie speichern oder an MTA-Funktionen übergeben und sie haben auch keinen darstellbaren Wert.
Wendet man tostring auf einen Userdata-Pointer an, so erhält man einen String in der Form "userdata: 0x090A34D". Die type-Funktion gibt "userdata" zurück, wenn man ihr ein Element übergibt.
</p><p><br />
</p>
<h3><span class="mw-headline" id="Der_Elementbaum">Der Elementbaum</span></h3>
<p>Den Elementbaum kann man sich wie einen Stammbaum vorstellen, nur dass der Ursprung bekannt ist.
Der Ursprung des Elementbaumes ist die sogenannte root (engl. für Wurzel). Aus ihr entspringen alle Elemente des ganzen Servers.
</p><p>Bevor ich nun versuche, ein Bild zu beschreiben, wie man sich das vorstellen soll, zeige ich lieber ein Beispiel für einen MTA Elementbaum im XML-Format. Dieser ist jedoch an einigen Stellen stark vereinfacht, da er sonst den Rahmen sprengen würde, jedoch verschlechtert das die Verbildlichung nicht.
</p>
<pre class="prettyprint lang-xml">&lt;root&gt;
    &lt;console/&gt;
    &lt;player dontRespawn="false"/&gt;
    &lt;player dontRespawn="false" lastSpawnarea=""/&gt;
    &lt;resource id="resourcebrowser"/&gt;
    &lt;resource id="ajax"/&gt;
    &lt;resource id="resourcemanager"/&gt;
    &lt;resource id="spawnmanager"/&gt;
    &lt;resource id="mapmanager"/&gt;
    &lt;resource id="runcode"/&gt;
    &lt;resource id="fr"&gt;
        &lt;map id="dynamic"&gt;
            &lt;vehicle/&gt;
        &lt;/map&gt;
    &lt;/resource&gt;
    &lt;resource id="elementbrowser"/&gt;
    &lt;resource id="assault"&gt;
        &lt;map id="dynamic"&gt;
            &lt;team/&gt;
            &lt;team/&gt;
            &lt;blip/&gt;
            &lt;marker/&gt;
            &lt;colshape/&gt;
            &lt;blip/&gt;
            &lt;blip/&gt;
        &lt;/map&gt;
    &lt;/resource&gt;
    &lt;resource id="as-farm"&gt;
        &lt;map id="dynamic"/&gt;
        &lt;map id="as-farm.map"&gt;
            &lt;meta&gt;
                &lt;author/&gt;
                &lt;version/&gt;
                &lt;name/&gt;
                &lt;description/&gt;
            &lt;/meta&gt;
            &lt;spawngroup req="" type="attacker"&gt;
                &lt;spawnarea posY="-8.3976354598999" posX="20.182683944702" skins="9" ... /&gt;
            &lt;/spawngroup&gt;
            &lt;spawngroup req="" type="attacker"&gt;
                &lt;spawnarea posY="32.166355133057" posX="-46.90763092041" skins="9" ... /&gt;
            &lt;/spawngroup&gt;
            &lt;spawngroup req="" type="attacker"&gt;
                &lt;spawnarea posY="35.214984893799" posX="-33.486911773682" skins="9" ... /&gt;
            &lt;/spawngroup&gt;
            &lt;spawngroup req="" type="attacker"&gt;
                &lt;spawnarea posY="35.214984893799" posX="-33.486911773682" skins="9" ... /&gt;
            &lt;/spawngroup&gt;
            &lt;objective id="first" type="checkpoint" description="Breach into the farm" ... /&gt;
            &lt;pickup type="weapon" ... /&gt;
        &lt;/map&gt;
    &lt;/resource&gt;
&lt;/root&gt;</pre>
<p>Wie man in diesem Beispiel sehr schön sehen kann, sind alle Spieler, Ressourcen und die Konsole (das schwarze Serverfenster) direkte Kindelemente vom root-Element. Letzteres könnt ihr im Script übrigens mit <a href="../GetRootElement.html" title="GetRootElement">getRootElement</a> bekommen.
Maps und Fahrzeuge wiederrum sind Kindelemente der jeweiligen Ressourcen und so weiter.
</p><p><br />
</p>
<h3><span class="mw-headline" id="Elemente_in_MTA-Funktionen">Elemente in MTA-Funktionen</span></h3>
<p>Die meisten MTA-Funktionen verlangen ein oder mehrere Elemente als Parameter oder geben eines zurück. Wenn man ein Element übergibt, was Kindelemente enthält, z.B. das root-Element, dann wendet MTA die Funktion auf alle Kindelemente des übergebenen Elements an, die dem Elementtypen entsprechen, der von der Funktion erwartet wird.
Der Typ eines Elements lässt sich mit <a href="../GetElementType.html" title="GetElementType">getElementType</a> herausfinden.
</p><p><br />
</p>
<h2><span class="mw-headline" id="Events">Events</span></h2>
<h3><span class="mw-headline" id="Beschreibung">Beschreibung</span></h3>
<p>Ein Event ist ein Ereignis. Das kann z.B. der Tod eines Spielers sein, aber auch das Beenden einer Ressource oder das Klicken auf einen Button.
</p><p>Ein Eventhandler ist eine Funktion, in unserem Fall eine Lua-Funktion, die aufgerufen wird, wenn ein bestimmtes Event stattfindet. Generell ist alles in MTA eventgesteuert und was nicht eventgesteuert ist, ist zeitgesteuert.
</p><p>Mit der Funktion <a href="../AddEventHandler.html" title="AddEventHandler">addEventHandler</a> kann man in MTA eine Eventhandlerfunktion hinzufügen. Im Wiki finden sich Listen mit vorhandenen <a href="../Server_Scripting_Events.html" title="Server Scripting Events">serverseitigen Events</a> und auch <a href="../Client_Scripting_Events.html" title="Client Scripting Events">clientseitigen Events</a>.
</p><p>Wenn ein Event eintritt, dann werden alle dazugehörigen Eventhandlerfunktionen in einer Umgebung aufgerufen, die die Variable source definiert als den Pointer zu dem Element, welches das Event hervorgerufen hat.
Das heißt im Klartext, dass in jeder Eventhandlerfunktion die Variable source das Element enthält, was das Ereignis herbeigeführt hat.
</p><p>Die Variablen root und resourceRoot sind in jeder Ressource vordefiniert, wobei root dem Rückgabewert von <a href="../GetRootElement.html" title="GetRootElement">getRootElement</a> und resourceRoot dem von <a href="../GetResourceRootElement.html" title="GetResourceRootElement">getResourceRootElement</a> entsprechen.
</p>
<h3><span class="mw-headline" id="Serverseitiges_Beispiel">Serverseitiges Beispiel</span></h3>
<pre class="prettyprint lang-lua">local gSpawnPosition = { 0, 0, 3 } -- Spawnposition

function onPlayerJoin()
    spawnPlayer(source, unpack(gSpawnPosition)) -- spawne den Spieler
    setCameraTarget(source) -- setze das Ziel seiner Kamera auf sich selbst
    fadeCamera(source, true) -- blende die Umgebung ein
    
    outputChatBox(getPlayerNametagText(source).." hat den Server betreten.") -- sende Nachricht an alle Spieler
end

function onPlayerQuit(quitType)
    outputChatBox(getPlayerNametagText(source).." hat den Server verlassen. (Grund: "..quitType..")") -- sende Nachricht an alle Spieler
end

function onPlayerWasted()
    spawnPlayer(source, getElementPosition(source)) -- respawne den Spieler
end

function onResourceStart()
    for _, player in next, getElementsByType("player") do -- für jedes Spielerelement...
        spawnPlayer(player, unpack(gSpawnPosition)) -- ...spawne den Spieler
        fadeCamera(player, true) -- ...blende die Umgebung ein
    end
end

function onResourceStop()
    for _, player in next, getElementsByType("player") do-- für jedes Spielerelement...
        fadeCamera(player, false) -- ...blende die Umgebung aus
    end
end

-- füge die Eventhandler hinzu
addEventHandler("onPlayerJoin", root, onPlayerJoin)
addEventHandler("onPlayerQuit", root, onPlayerQuit)
addEventHandler("onPlayerWasted", root, onPlayerWasted)
addEventHandler("onResourceStart", resourceRoot, onResourceStart)
addEventHandler("onResourceStop", resourceRoot, onResourceStop)</pre>
<p>Man sollte immer bedenken, dass Spielerelemente auf dem gleichen Level sind wie Ressourcenelemente, d.h., dass Spieler auch ohne dass Ressourcen laufen auf dem Server sein können, also auch schon, wenn eine Ressource startet.
</p><p><br />
</p>
<h2><span class="mw-headline" id="Commands">Commands</span></h2>
<h3><span class="mw-headline" id="Beschreibung_2">Beschreibung</span></h3>
<p>Commands sind Befehle, die der Spieler beginnend mit einem Schrägstrich (/) im Chat benutzen kann, um bestimmte Funktionen auszuführen.
Aufgrund der großen Bandbreite von alternativen Eingabemethoden wie Klicken auf Elemente in der Spielwelt oder GUI-Elemente zählen Commands eher zu den veralteten und unbequemen Eingabemethoden.
</p><p>Der Ablauf ist ganz einfach: Der Spieler gibt einen Command ein, eventuell mit einem oder mehreren Parametern und MTA ruft eine Lua Funktion auf, der das Element des Spielers, der eingegebene Command sowie die übergebenen Parameter übermittelt werden.
Bei der Eingabe werden die Parameter einfach durch Leerzeichen getrennt. Beispiel: /command param1 param2 param3
</p><p>Commandhandlerfunktionen werden in MTA mit der Funktion <a href="../AddCommandHandler.html" title="AddCommandHandler">addCommandHandler</a> hinzugefügt. Dazu nun einfach mal ein Beispiel für ein einfaches PM-System.
</p><p><br />
</p>
<h3><span class="mw-headline" id="Serverseitiges_Beispiel_2">Serverseitiges Beispiel</span></h3>
<pre class="prettyprint lang-lua">function cmdPrivateMessage(source, cmd, targetname, ...)
    --[[ da auch die eigentliche Nachricht an den Leerzeichen gespalten und als einzelne Parameter übergeben wird,
         muss man mit dem ...-Parameter eine nicht festgelegte Anzahl Parameter (jeder in diesem Fall ein Wort)
         entgegennehmen und diese wieder zusammenfügen ]]
    local message = table.concat({...}, " ")
    
    if (message == "") then -- wenn die Nachricht leer ist, wenn also kein Spielername und/oder keine Nachricht übergeben wurde
        outputChatBox("Syntax: /pm [str:Spielername] [str:Nachricht]", source, 240, 0, 0) -- Ausgabe der korrekten Syntax
        return -- Abbruch der Funktion
    end
    
    local target = getPlayerFromNick(targetname) -- suche nach einem Spielerelement mit dem gegebenen Namen
    if (not target) then -- wenn kein Spielerelement gefunden wurde
        outputChatBox(targetname.." existiert nicht oder ist offline.", source, 240, 0 , 0) -- Ausgabe einer Fehlermeldung
        return -- Abbruch der Funktion
    end
    
    -- ab hier ist gewährleistet, dass alle benötigten Daten vorhanden und gültig sind
    outputChatBox("PM an "..targetname..": "..message, source, 200, 60, 0) -- Ausgabe einer Nachricht an den Sender
    outputChatBox("PM von "..getPlayerNametagText(source)..": "..message, target, 240, 100, 0) -- Ausgabe einer Nachricht an den Empfänger
end

-- Hinzufügen des Commandhandlers
addCommandHandler("pm", cmdPrivateMessage, false, false)</pre>
<p>Commandparameter werden immer als strings übergeben.
</p>
<!-- 
NewPP limit report
Cached time: 20220727213126
Cache expiry: 86400
Reduced expiry: false
Complications: []
CPU time usage: 0.012 seconds
Real time usage: 0.013 seconds
Preprocessor visited node count: 122/1000000
Post‐expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/100
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 8248/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.000      1 -total
-->

<!-- Saved in parser cache with key wiki-wiki_dev_:pcache:idhash:4830-0!canonical and timestamp 20220727213126 and revision id 54097. Serialized with JSON.
 -->
</div>
<div class="printfooter">Retrieved from "<a dir="ltr" href="https://wiki.multitheftauto.com/index.php?title=DE/MTA_Scripting_Grundlagen&amp;oldid=54097">https://wiki.multitheftauto.com/index.php?title=DE/MTA_Scripting_Grundlagen&amp;oldid=54097</a>"</div></div>
		<div id="catlinks" class="catlinks catlinks-allhidden" data-mw="interface"></div>
	</div>
</div>

<div id="mw-navigation">
	<h2>Navigation menu</h2>
	<div id="mw-head">
		
<nav id="p-personal" class="mw-portlet mw-portlet-personal vector-user-menu-legacy vector-menu" aria-labelledby="p-personal-label" role="navigation" 
	 >
	<label id="p-personal-label" aria-label="" class="vector-menu-heading">
		<span class="vector-menu-heading-label">Personal tools</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="pt-createaccount" class="mw-list-item"><a href="https://wiki.multitheftauto.com/index.php?title=Special:CreateAccount&amp;returnto=DE%2FMTA+Scripting+Grundlagen" title="You are encouraged to create an account and log in; however, it is not mandatory"><span>Create account</span></a></li><li id="pt-login" class="mw-list-item"><a href="https://wiki.multitheftauto.com/index.php?title=Special:UserLogin&amp;returnto=DE%2FMTA+Scripting+Grundlagen" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o"><span>Log in</span></a></li></ul>
		
	</div>
</nav>

		<div id="left-navigation">
			
<nav id="p-namespaces" class="mw-portlet mw-portlet-namespaces vector-menu vector-menu-tabs" aria-labelledby="p-namespaces-label" role="navigation" 
	 >
	<label id="p-namespaces-label" aria-label="" class="vector-menu-heading">
		<span class="vector-menu-heading-label">Namespaces</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="ca-nstab-main" class="selected mw-list-item"><a href="MTA_Scripting_Grundlagen.html" title="View the content page [c]" accesskey="c"><span>Page</span></a></li><li id="ca-talk" class="new mw-list-item"><a href="https://wiki.multitheftauto.com/index.php?title=Talk:DE/MTA_Scripting_Grundlagen&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page (page does not exist) [t]" accesskey="t"><span>Discussion</span></a></li></ul>
		
	</div>
</nav>

			
<nav id="p-variants" class="mw-portlet mw-portlet-variants emptyPortlet vector-menu-dropdown-noicon vector-menu vector-menu-dropdown" aria-labelledby="p-variants-label" role="navigation" 
	 >
	<input type="checkbox"
		id="p-variants-checkbox"
		role="button"
		aria-haspopup="true"
		data-event-name="ui.dropdown-p-variants"
		class="vector-menu-checkbox" aria-labelledby="p-variants-label" />
	<label id="p-variants-label" aria-label="Change language variant" class="vector-menu-heading">
		<span class="vector-menu-heading-label">English</span>
			<span class="vector-menu-checkbox-expanded">expanded</span>
			<span class="vector-menu-checkbox-collapsed">collapsed</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</nav>

		</div>
		<div id="right-navigation">
			
<nav id="p-views" class="mw-portlet mw-portlet-views vector-menu vector-menu-tabs" aria-labelledby="p-views-label" role="navigation" 
	 >
	<label id="p-views-label" aria-label="" class="vector-menu-heading">
		<span class="vector-menu-heading-label">Views</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="ca-view" class="selected mw-list-item"><a href="MTA_Scripting_Grundlagen.html"><span>Read</span></a></li><li id="ca-viewsource" class="mw-list-item"><a href="https://wiki.multitheftauto.com/index.php?title=DE/MTA_Scripting_Grundlagen&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e"><span>View source</span></a></li><li id="ca-history" class="mw-list-item"><a href="https://wiki.multitheftauto.com/index.php?title=DE/MTA_Scripting_Grundlagen&amp;action=history" title="Past revisions of this page [h]" accesskey="h"><span>View history</span></a></li></ul>
		
	</div>
</nav>

			
<nav id="p-cactions" class="mw-portlet mw-portlet-cactions emptyPortlet vector-menu-dropdown-noicon vector-menu vector-menu-dropdown" aria-labelledby="p-cactions-label" role="navigation"  title="More options"
	 >
	<input type="checkbox"
		id="p-cactions-checkbox"
		role="button"
		aria-haspopup="true"
		data-event-name="ui.dropdown-p-cactions"
		class="vector-menu-checkbox" aria-labelledby="p-cactions-label" />
	<label id="p-cactions-label" aria-label="" class="vector-menu-heading">
		<span class="vector-menu-heading-label">More</span>
			<span class="vector-menu-checkbox-expanded">expanded</span>
			<span class="vector-menu-checkbox-collapsed">collapsed</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</nav>

			
<div id="p-search" role="search" class="vector-search-box-vue  vector-search-box-show-thumbnail vector-search-box-auto-expand-width vector-search-box">
	<div>
			<h3 >
				<label for="searchInput">Search</label>
			</h3>
		<form action="https://wiki.multitheftauto.com/index.php" id="searchform"
			class="vector-search-box-form">
			<div id="simpleSearch"
				class="vector-search-box-inner"
				 data-search-loc="header-navigation">
				<input class="vector-search-box-input"
					 type="search" name="search" placeholder="Search Multi Theft Auto: Wiki" aria-label="Search Multi Theft Auto: Wiki" autocapitalize="sentences" title="Search Multi Theft Auto: Wiki [f]" accesskey="f" id="searchInput"
				/>
				<input type="hidden" name="title" value="Special:Search"/>
				<input id="mw-searchButton"
					 class="searchButton mw-fallbackSearchButton" type="submit" name="fulltext" title="Search the pages for this text" value="Search" />
				<input id="searchButton"
					 class="searchButton" type="submit" name="go" title="Go to a page with this exact name if it exists" value="Go" />
			</div>
		</form>
	</div>
</div>

		</div>
	</div>
	

<div id="mw-panel">
	<div id="p-logo" role="banner">
		<a class="mw-wiki-logo" href="../Main_Page.html"
			title="Visit the main page"></a>
	</div>
	
<nav id="p-navigation" class="mw-portlet mw-portlet-navigation vector-menu vector-menu-portal portal" aria-labelledby="p-navigation-label" role="navigation" 
	 >
	<label id="p-navigation-label" aria-label="" class="vector-menu-heading">
		<span class="vector-menu-heading-label">Navigation</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="n-Home" class="mw-list-item"><a href="../Main_Page.html"><span>Home</span></a></li><li id="n-How-you-can-help" class="mw-list-item"><a href="../How_you_can_help.html"><span>How you can help</span></a></li><li id="n-recentchanges" class="mw-list-item"><a href="../Special_RecentChanges.html" icon="recentChanges" title="A list of recent changes in the wiki [r]" accesskey="r"><span>Recent changes</span></a></li><li id="n-randompage" class="mw-list-item"><a href="../GetPlayerOccupiedVehicleSeat.html" icon="die" title="Load a random page [x]" accesskey="x"><span>Random page</span></a></li></ul>
		
	</div>
</nav>

	
<nav id="p-Reference" class="mw-portlet mw-portlet-Reference vector-menu vector-menu-portal portal" aria-labelledby="p-Reference-label" role="navigation" 
	 >
	<label id="p-Reference-label" aria-label="" class="vector-menu-heading">
		<span class="vector-menu-heading-label">Reference</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="n-Client-Functions" class="mw-list-item"><a href="../Client_Scripting_Functions.html"><span>Client Functions</span></a></li><li id="n-Client-Events" class="mw-list-item"><a href="../Client_Scripting_Events.html"><span>Client Events</span></a></li><li id="n-Server-Functions" class="mw-list-item"><a href="../Server_Scripting_Functions.html"><span>Server Functions</span></a></li><li id="n-Server-Events" class="mw-list-item"><a href="../Server_Scripting_Events.html"><span>Server Events</span></a></li><li id="n-Shared-Functions" class="mw-list-item"><a href="../Shared_Scripting_Functions.html"><span>Shared Functions</span></a></li><li id="n-Useful-Functions" class="mw-list-item"><a href="../Useful_Functions.html"><span>Useful Functions</span></a></li><li id="n-MTA-Classes" class="mw-list-item"><a href="../MTA_Classes.html"><span>MTA Classes</span></a></li><li id="n-MTA-Elements" class="mw-list-item"><a href="../Element.html"><span>MTA Elements</span></a></li><li id="n-Element-Tree" class="mw-list-item"><a href="../Element_tree.html"><span>Element Tree</span></a></li></ul>
		
	</div>
</nav>

<nav id="p-tb" class="mw-portlet mw-portlet-tb vector-menu vector-menu-portal portal" aria-labelledby="p-tb-label" role="navigation" 
	 >
	<label id="p-tb-label" aria-label="" class="vector-menu-heading">
		<span class="vector-menu-heading-label">Tools</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="t-whatlinkshere" class="mw-list-item"><a href="../Special_WhatLinksHere/DE/MTA_Scripting_Grundlagen.html" title="A list of all wiki pages that link here [j]" accesskey="j"><span>What links here</span></a></li><li id="t-recentchangeslinked" class="mw-list-item"><a href="../Special_RecentChangesLinked/DE/MTA_Scripting_Grundlagen.html" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k"><span>Related changes</span></a></li><li id="t-specialpages" class="mw-list-item"><a href="../Special_SpecialPages.html" title="A list of all special pages [q]" accesskey="q"><span>Special pages</span></a></li><li id="t-print" class="mw-list-item"><a href="javascript:print();" rel="alternate" title="Printable version of this page [p]" accesskey="p"><span>Printable version</span></a></li><li id="t-permalink" class="mw-list-item"><a href="https://wiki.multitheftauto.com/index.php?title=DE/MTA_Scripting_Grundlagen&amp;oldid=54097" title="Permanent link to this revision of the page"><span>Permanent link</span></a></li><li id="t-info" class="mw-list-item"><a href="https://wiki.multitheftauto.com/index.php?title=DE/MTA_Scripting_Grundlagen&amp;action=info" title="More information about this page"><span>Page information</span></a></li></ul>
		
	</div>
</nav>

	
</div>

</div>

<footer id="footer" class="mw-footer" role="contentinfo" >
	<ul id="footer-info">
	<li id="footer-info-lastmod"> This page was last edited on 6 March 2018, at 19:21.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/licenses/fdl-1.3.html">GNU Free Documentation License 1.3</a> unless otherwise noted.</li>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="../Multi_Theft_Auto__Wiki_Privacy_policy.html" title="Multi Theft Auto: Wiki:Privacy policy">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../Multi_Theft_Auto__Wiki_About.html" title="Multi Theft Auto: Wiki:About">About Multi Theft Auto: Wiki</a></li>
	<li id="footer-places-disclaimer"><a href="../Multi_Theft_Auto__Wiki_General_disclaimer.html" title="Multi Theft Auto: Wiki:General disclaimer">Disclaimers</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/licenses/fdl-1.3.html"><img src="../../resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3" width="88" height="31" loading="lazy"/></a></li>
	<li id="footer-poweredbyico"><a href="https://www.mediawiki.org/"><img src="../../resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"/></a></li>
</ul>

</footer>

<script src="../../extensions/_MTAThemeExtensions/main.js"></script><script src="../../extensions/_MTAThemeExtensions/topmenu.js"></script>
<script>(RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgPageParseReport":{"limitreport":{"cputime":"0.012","walltime":"0.013","ppvisitednodes":{"value":122,"limit":1000000},"postexpandincludesize":{"value":0,"limit":2097152},"templateargumentsize":{"value":0,"limit":2097152},"expansiondepth":{"value":2,"limit":100},"expensivefunctioncount":{"value":0,"limit":100},"unstrip-depth":{"value":0,"limit":20},"unstrip-size":{"value":8248,"limit":5000000},"timingprofile":["100.00%    0.000      1 -total"]},"cachereport":{"timestamp":"20220727213126","ttl":86400,"transientcontent":false}}});mw.config.set({"wgBackendResponseTime":70});});</script>
</body>
</html>