<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8"/>
<title>Translating - Multi Theft Auto: Wiki</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Translating","wgTitle":"Translating","wgCurRevisionId":25185,"wgRevisionId":25185,"wgArticleId":5514,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Translating","wgRelevantArticleId":5514,"wgRequestId":"c7b93f4329ffa5944afe5e96","wgIsProbablyEditable":false,"wgRelevantPageIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgWikiEditorEnabledModules":[]});mw.loader.state({"site.styles":"ready","noscript":"ready","user.styles":"ready","user":"ready","user.options":"ready","user.tokens":"loading","mediawiki.legacy.shared":"ready","mediawiki.legacy.commonPrint":"ready","mediawiki.sectionAnchor":"ready","mediawiki.skinning.interface":"ready","mediawiki.skinning.content.externallinks":"ready","skins.monobook.styles":"ready"});mw.loader.implement("user.tokens@18hksfp",function($,jQuery,require,module){/*@nomin*/mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});
});mw.loader.load(["site","mediawiki.page.startup","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.toc","mediawiki.searchSuggest","ext.GoogleCodePrettify"]);});</script>
<link rel="stylesheet" href="http://wiki.localhost/load.php?debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cmediawiki.skinning.content.externallinks%7Cmediawiki.skinning.interface%7Cskins.monobook.styles&amp;only=styles&amp;skin=monobook"/>
<script async="" src="http://wiki.localhost/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=monobook"></script>
<!--[if IE 6]><link rel="stylesheet" href="/skins/MonoBook/resources/IE60Fixes.css?303" media="screen"/><![endif]--><!--[if IE 7]><link rel="stylesheet" href="/skins/MonoBook/resources/IE70Fixes.css?303" media="screen"/><![endif]-->
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="http://wiki.localhost/load.php?debug=false&amp;lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=monobook"/>
<meta name="generator" content="MediaWiki 1.31.3"/>
<link rel="shortcut icon" href="http://wiki.localhost/favicon.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="http://wiki.localhost/opensearch_desc.php" title="Multi Theft Auto: Wiki (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.multitheftauto.com/api.php?action=rsd"/>
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html"/>
<link rel="alternate" type="application/atom+xml" title="Multi Theft Auto: Wiki Atom feed" href="http://wiki.localhost/index.php?title=Special:RecentChanges&amp;feed=atom"/>
<!--[if lt IE 9]><script src="/load.php?debug=false&amp;lang=en&amp;modules=html5shiv&amp;only=scripts&amp;skin=MonoBook&amp;sync=1"></script><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Translating rootpage-Translating skin-monobook action-view"><div id="globalWrapper"><div id="column-content"><div id="content" class="mw-body" role="main"><a id="top"></a><div class="mw-indicators mw-body-content">
</div>
<h1 id="firstHeading" class="firstHeading" lang="en">Translating</h1><div id="bodyContent" class="mw-body-content"><div id="siteSub">From Multi Theft Auto: Wiki</div><div id="contentSub" lang="en" dir="ltr"></div><div id="jump-to-nav" class="mw-jump">Jump to:<a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div><!-- start content --><div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output"><p>It's proposed that we have a way of translating MTA into different languages, and allowing our community to contribute their translations.
</p>
<div id="toc" class="toc"><div class="toctitle" lang="en" dir="ltr"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Why.3F"><span class="tocnumber">1</span> <span class="toctext">Why?</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#How"><span class="tocnumber">2</span> <span class="toctext">How</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#The_code"><span class="tocnumber">3</span> <span class="toctext">The code</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Generating_the_translation_template"><span class="tocnumber">4</span> <span class="toctext">Generating the translation template</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Editing"><span class="tocnumber">5</span> <span class="toctext">Editing</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Where.3F"><span class="tocnumber">6</span> <span class="toctext">Where?</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Making_it_work"><span class="tocnumber">7</span> <span class="toctext">Making it work</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Files"><span class="tocnumber">8</span> <span class="toctext">Files</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#What.3F"><span class="tocnumber">9</span> <span class="toctext">What?</span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#User_Interface"><span class="tocnumber">10</span> <span class="toctext">User Interface</span></a></li>
<li class="toclevel-1 tocsection-11"><a href="#The_hard_work"><span class="tocnumber">11</span> <span class="toctext">The hard work</span></a></li>
<li class="toclevel-1 tocsection-12"><a href="#The_really_hard_work"><span class="tocnumber">12</span> <span class="toctext">The really hard work</span></a></li>
<li class="toclevel-1 tocsection-13"><a href="#What_else.3F"><span class="tocnumber">13</span> <span class="toctext">What else?</span></a></li>
<li class="toclevel-1 tocsection-14"><a href="#Notes"><span class="tocnumber">14</span> <span class="toctext">Notes</span></a></li>
</ul>
</div>

<h2><span id="Why?"></span><span class="mw-headline" id="Why.3F">Why?</span></h2>
<p>We've seen a couple of people try to fork MTA to make arabic and polish translations. We want to discourage forking for such trivial reasons if we can. Also, we'd encourage more players to play MTA if they can understand it.
</p>
<h2><span class="mw-headline" id="How">How</span></h2>
<p>The library <i>gettext</i> seems to be the standard way of doing this, at least in the Linux world.
</p><p>Writing our own seems to be a bad idea - we don't know enough about languages to do this.
</p><p>We should be able to use utf8 to encode the strings, meaning very little of our code should need to change. Most of our current support for unicode is done with utf8 so this seems easy. It remains to be seen how much needs to be changed to support this.
</p>
<h2><span class="mw-headline" id="The_code">The code</span></h2>
<p>Gettext works by wrapping strings in calls to the <i>gettext</i> function.
So:
</p>
<pre class="prettyprint lang-lua">[c++]
Print ( "Press Q to shut down the server!\n" );
</pre>
<p>Becomes:
</p>
<pre class="prettyprint lang-lua">[c++]
Print ( gettext("Press Q to shut down the server!\n") );
</pre>
<p>Though, we probably don't want to include new line characters, so it becomes:
</p>
<pre class="prettyprint lang-lua">[c++]
Print ( "%s\n", gettext("Press Q to shut down the server!"));
</pre>
<p>Plus, it can be convenient to have a shorthand, and it seems that defining _ as gettext is conventional, so you end up with:
</p>
<pre class="prettyprint lang-lua">[c++]
Print ( "%s\n", _("Press Q to shut down the server!"));
</pre>
<p>Maybe we should make a short hand version of Print that always does a new line?
</p>
<h2><span class="mw-headline" id="Generating_the_translation_template">Generating the translation template</span></h2>
<p>From the code you can generate the template that lists the strings that need to be generated. gettext comes with a tool for this, and I've wrapped it up in a script that makes it more convenient. It's currently utils/build_gettext_catalog.py (though not yet committed).
</p><p>This scans all the cpp and h files in the MTA10 and MTA10_SERVER directories and passes them into the xgettext executable which generates a <i>pot</i> file, which looks something like the following:
</p>
<pre class="prettyprint lang-lua"># SOME DESCRIPTIVE TITLE.
# Copyright (C) YEAR THE PACKAGE'S COPYRIGHT HOLDER
# This file is distributed under the same license as the PACKAGE package.
# FIRST AUTHOR &lt;EMAIL@ADDRESS&gt;, YEAR.
#
#, fuzzy
msgid ""
msgstr ""
"Project-Id-Version: PACKAGE VERSION\n"
"Report-Msgid-Bugs-To: \n"
"POT-Creation-Date: 2010-12-20 19:27+0000\n"
"PO-Revision-Date: YEAR-MO-DA HO:MI+ZONE\n"
"Last-Translator: FULL NAME &lt;EMAIL@ADDRESS&gt;\n"
"Language-Team: LANGUAGE &lt;LL@li.org&gt;\n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=CHARSET\n"
"Content-Transfer-Encoding: 8bit\n"

#. Couldn't load our mod
msgid "Press Q to shut down the server!"
msgstr ""
</pre>
<p>Notice that comments from the code are extracted and placed above the strings, so we can provide guidance for what each string's purpose is.
</p>
<h2><span class="mw-headline" id="Editing">Editing</span></h2>
<p>The template itself isn't edited, I think. You can create a copy of it and generate a new translation by filling in the msgstr strings. There are editors, such as the cross platform poedit that deals with these files and handles various useful things such as validating them and merging them when new strings are added to the template. This seems pretty easy to use. It notices things such as missing formatting specifiers (%s etc) in strings.
</p><p>Once you've edited the file, you can save it as a .po file. This is basically identical to the .pot file, just has translations in it.
</p><p>These files are turned into .mo files which are compiled versions. Poedit does this for you, but I've made a script that does it in the utils directory.
</p>
<h2><span id="Where?"></span><span class="mw-headline" id="Where.3F">Where?</span></h2>
<p>I've placed the translations in a root <i>Translations</i> directory (alongside MTA10 and MTA10_SERVER). The translations are shared between client and server, I'm not sure if this is a good or bad thing, but it could be changed. It might save work and disk space somewhat, though we probably want the translations to be placed in the server and client directories anyway.
</p>
<h2><span class="mw-headline" id="Making_it_work">Making it work</span></h2>
<p>To make it work, you link against libintl.lib (in vendor/gettext/libs) and have the dll libintl3.dll along side the executables.
</p><p>Currently I've only tested this in the CServerImpl.cpp file, adding this at the top:
</p>
<pre class="prettyprint lang-lua">[c++]
#include &lt;libintl.h&gt;
#define _ gettext
</pre>
<p>Then this in the constructor:
</p>
<pre class="prettyprint lang-lua">[c++]
char* s = setlocale(LC_ALL, "");
bindtextdomain("messages", "translations/"); // specifies the directory to look in
textdomain( "messages");
</pre>
<h2><span class="mw-headline" id="Files">Files</span></h2>
<p>We would ship the .mo files. Each language would have a directory in the Translations directory, e.g. en_US, fr_FR etc, inside which is a directory LC_MESSAGES, inside which is a messages.mo file. We can't really change anything except where this directory is and what the .mo file is called, the locale and the LC_MESSAGES directories have to be there. It seems.
</p>
<h2><span id="What?"></span><span class="mw-headline" id="What.3F">What?</span></h2>
<p>We ideally allow every part of MTA client and server to be translated. The server is less important, but we ought to do it if we can.
</p>
<h2><span class="mw-headline" id="User_Interface">User Interface</span></h2>
<p>We'd need to provide a user interface for changing language. We can use the system settings (somehow - gettext may do this for us?) to work out the right language. But often, users may be more comfortable with another language (or their translation might be awful).
</p><p>This would make most sense to be in the 'Interface' tab of the client settings. Server-side, we'd provide a config setting.
</p>
<h2><span class="mw-headline" id="The_hard_work">The hard work</span></h2>
<p>Once the system is set up, some people need to go through and mark up each string that we want to be translatable. This could be anyone really as coding isn't really required (except with some odd strings perhaps).
</p>
<h2><span class="mw-headline" id="The_really_hard_work">The really hard work</span></h2>
<p>Getting people to translate it is obviously hard work. But I imagine we have a lot of keen community members who will do this, if we release the relevant files and isnstruct them on how to do it. As the tools we're using are fairly standard, we may find that people already know how to use them if they've translated other projects.
</p>
<h2><span id="What_else?"></span><span class="mw-headline" id="What_else.3F">What else?</span></h2>
<p>Perhaps we want to add a 'server language' setting that gets shown in the server browser. I'm not sure if we want to encourage such ghettoization, but it might be of benefit to our users.
</p>
<h2><span class="mw-headline" id="Notes">Notes</span></h2>
<p>Do we need strlen to not work on utf8 strings in 1.1? Could we just make it the same as utf8len (or whatever it's called)?
</p>
<!-- 
NewPP limit report
Cached time: 20191016151806
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.015 seconds
Real time usage: 0.016 seconds
Preprocessor visited node count: 118/1000000
Preprocessor generated node count: 200/1000000
Post‐expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 1388/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.000      1 -total
-->
</div>
<!-- Saved in parser cache with key mta_wiki-wiki_dev_:pcache:idhash:5514-0!canonical and timestamp 20191016151806 and revision id 25185
 -->
</div><div class="printfooter">
Retrieved from "<a dir="ltr" href="https://wiki.multitheftauto.com/index.php?title=Translating&amp;oldid=25185">https://wiki.multitheftauto.com/index.php?title=Translating&amp;oldid=25185</a>"</div>
<div id="catlinks" class="catlinks catlinks-allhidden" data-mw="interface"></div><!-- end content --><div class="visualClear"></div></div></div></div><div id="column-one" lang="en" dir="ltr"><h2>Navigation menu</h2><div role="navigation" class="portlet" id="p-cactions" aria-labelledby="p-cactions-label"><h3 id="p-cactions-label" lang="en" dir="ltr">Views</h3><div class="pBody"><ul lang="en" dir="ltr"><li id="ca-nstab-main" class="selected"><a href="Translating.html" title="View the content page [c]" accesskey="c">Page</a></li><li id="ca-talk"><a href="Talk_Translating.html" rel="discussion" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li><li id="ca-viewsource"><a href="http://wiki.localhost/index.php?title=Translating&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></li><li id="ca-history"><a href="http://wiki.localhost/index.php?title=Translating&amp;action=history" title="Past revisions of this page [h]" accesskey="h">History</a></li></ul></div></div><div role="navigation" class="portlet" id="p-personal" aria-labelledby="p-personal-label"><h3 id="p-personal-label" lang="en" dir="ltr">Personal tools</h3><div class="pBody"><ul lang="en" dir="ltr"><li id="pt-createaccount"><a href="http://wiki.localhost/index.php?title=Special:CreateAccount&amp;returnto=Translating" title="You are encouraged to create an account and log in; however, it is not mandatory">Create account</a></li><li id="pt-login"><a href="http://wiki.localhost/index.php?title=Special:UserLogin&amp;returnto=Translating" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li></ul></div></div><div class="portlet" id="p-logo" role="banner"><a href="Main_Page.html" class="mw-wiki-logo" title="Visit the main page"></a></div><div role="navigation" class="portlet generated-sidebar" id="p-navigation" aria-labelledby="p-navigation-label"><h3 id="p-navigation-label" lang="en" dir="ltr">Navigation</h3><div class="pBody"><ul lang="en" dir="ltr"><li id="n-Home"><a href="Main_Page.html">Home</a></li><li id="n-How-you-can-help"><a href="How_you_can_help.html">How you can help</a></li><li id="n-recentchanges"><a href="Special_RecentChanges.html" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li><li id="n-randompage"><a href="https://wiki.multitheftauto.com/wiki/JavaSDK" title="Load a random page [x]" accesskey="x">Random page</a></li></ul></div></div><div role="navigation" class="portlet generated-sidebar" id="p-reference" aria-labelledby="p-reference-label"><h3 id="p-reference-label" lang="en" dir="ltr">reference</h3><div class="pBody"><ul lang="en" dir="ltr"><li id="n-Client-Functions"><a href="Client_Scripting_Functions.html">Client Functions</a></li><li id="n-Client-Events"><a href="Client_Scripting_Events.html">Client Events</a></li><li id="n-Server-Functions"><a href="Server_Scripting_Functions.html">Server Functions</a></li><li id="n-Server-Events"><a href="Server_Scripting_Events.html">Server Events</a></li><li id="n-Shared-Functions"><a href="Shared_Scripting_Functions.html">Shared Functions</a></li><li id="n-Useful-Functions"><a href="Useful_Functions.html">Useful Functions</a></li><li id="n-MTA-Classes"><a href="MTA_Classes.html">MTA Classes</a></li><li id="n-MTA-Elements"><a href="Element.html">MTA Elements</a></li><li id="n-Element-Tree"><a href="Element_tree.html">Element Tree</a></li></ul></div></div><div role="search" class="portlet" id="p-search"><h3 id="p-search-label" lang="en" dir="ltr"><label for="searchInput">Search</label></h3><div class="pBody" id="searchBody"><form action="http://wiki.localhost/index.php" id="searchform"><input type="hidden" value="Special:Search" name="title"/><input type="search" name="search" placeholder="Search Multi Theft Auto: Wiki" title="Search Multi Theft Auto: Wiki [f]" accesskey="f" id="searchInput"/><input type="submit" name="go" value="Go" title="Go to a page with this exact name if it exists" id="searchGoButton" class="searchButton"/>&#160; <input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton"/></form></div></div><div role="navigation" class="portlet" id="p-tb" aria-labelledby="p-tb-label"><h3 id="p-tb-label" lang="en" dir="ltr">Tools</h3><div class="pBody"><ul lang="en" dir="ltr"><li id="t-whatlinkshere"><a href="Special_WhatLinksHere/Translating.html" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li><li id="t-recentchangeslinked"><a href="Special_RecentChangesLinked/Translating.html" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li><li id="t-specialpages"><a href="Special_SpecialPages.html" title="A list of all special pages [q]" accesskey="q">Special pages</a></li><li id="t-print"><a href="http://wiki.localhost/index.php?title=Translating&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li><li id="t-permalink"><a href="http://wiki.localhost/index.php?title=Translating&amp;oldid=25185" title="Permanent link to this revision of the page">Permanent link</a></li><li id="t-info"><a href="http://wiki.localhost/index.php?title=Translating&amp;action=info" title="More information about this page">Page information</a></li></ul></div></div></div><!-- end of the left (by default at least) column --><div class="visualClear"></div><div id="footer" role="contentinfo" lang="en" dir="ltr"><div id="f-copyrightico" class="footer-icons"><a href="http://www.gnu.org/copyleft/fdl.html"><img src="../resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.2" width="88" height="31"/></a></div><div id="f-poweredbyico" class="footer-icons"><a href="http://www.mediawiki.org/"><img src="../resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31"/></a></div><ul id="f-list"><li id="lastmod"> This page was last edited on 15 January 2011, at 19:52.</li><li id="copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.2</a> unless otherwise noted.</li><li id="privacy"><a href="Multi_Theft_Auto__Wiki_Privacy_policy.html" title="Multi Theft Auto: Wiki:Privacy policy">Privacy policy</a></li><li id="about"><a href="Multi_Theft_Auto__Wiki_About.html" title="Multi Theft Auto: Wiki:About">About Multi Theft Auto: Wiki</a></li><li id="disclaimer"><a href="Multi_Theft_Auto__Wiki_General_disclaimer.html" title="Multi Theft Auto: Wiki:General disclaimer">Disclaimers</a></li></ul></div></div><script src="../extensions/_MTAThemeExtensions/main11b9.js?303"></script><script src="../extensions/_MTAThemeExtensions/topmenu11b9.js?303"></script>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgPageParseReport":{"limitreport":{"cputime":"0.015","walltime":"0.016","ppvisitednodes":{"value":118,"limit":1000000},"ppgeneratednodes":{"value":200,"limit":1000000},"postexpandincludesize":{"value":0,"limit":2097152},"templateargumentsize":{"value":0,"limit":2097152},"expansiondepth":{"value":2,"limit":40},"expensivefunctioncount":{"value":0,"limit":100},"unstrip-depth":{"value":0,"limit":20},"unstrip-size":{"value":1388,"limit":5000000},"timingprofile":["100.00%    0.000      1 -total"]},"cachereport":{"timestamp":"20191016151806","ttl":86400,"transientcontent":false}}});});</script><script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":62});});</script></body></html>